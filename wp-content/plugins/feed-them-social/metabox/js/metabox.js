function plu_show_thumbs(e,t){for(var a=jQuery,i=a(".thumb"),r="list_item_"+t,o=a("#"+e).val(),l=o.split(","),s=0;s<l.length;s++)if(l[s]){var n=a('<li class="thumb thumb-new" id="'+r+'"><img src="'+l[s]+'" alt="" /><div class="thumbi"><a id="thumbremovelink'+e+s+'" href="#" style="display: none">Delete</a></div> <div class="clear"></div></li>');a("#img1plupload-thumbs").prepend(n),n.find("a").click((function(){var e=a(this).attr("id").replace("thumbremovelink"+r,"");e=parseInt(e);var t=[];o=a("#"+r).val(),l=o.split(",");for(var i=0;i<l.length;i++)i!=e&&(t[t.length]=l[i]);return!1}))}jQuery("#img1plupload-thumbs").sortable({items:"li",opacity:1,cursor:"move",update:function(){var e=jQuery(this).data("post-id"),t=jQuery(this).sortable("serialize")+"&action=list_update_order";jQuery.post(ajaxurl,t,(function(t){console.log(t),console.log(e)}))}}),i.disableSelection()}jQuery(document).ready((function(e){e("a#dgd_library_button").click((function(e){var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"insert-image",title:"Insert Image Url",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!0,type:"image"},wp.media.controller.Library.prototype.defaults)}),a=wp.media({button:{text:"Select"},state:"insert-image",states:[new t]});a.on("close",(function(){a.state("insert-image").get("selection").length})),a.on("select",(function(){var e=a.state("insert-image"),t=e.get("selection");console.log(t),t&&t.each((function(t){var a,i,r=e.display(t).toJSON(),o=t.toJSON(),l=o.caption;if(wp.media.view.settings.captions||delete o.caption,r=wp.media.string.props(r,o),a={id:o.id,post_content:o.description,post_excerpt:l},r.linkUrl&&(a.url=r.linkUrl),"image"===o.type?(i=wp.media.string.image(r),_.each({align:"align",size:"image-size",alt:"image_alt"},(function(e,t){r[t]&&(a[e]=r[t])}))):"video"===o.type?i=wp.media.string.video(r,o):"audio"===o.type?i=wp.media.string.audio(r,o):(i=wp.media.string.link(r),a.post_title=r.title),t.attributes.nonce=wp.media.view.settings.nonce.sendToEditor,t.attributes.attachment=a,t.attributes.html=i,t.attributes.post_id=wp.media.view.settings.post.id,t.attributes.sizes.fts_thumb)var s=t.attributes.sizes.fts_thumb.url;else s=t.attributes.sizes.thumbnail.url;jQuery("#img1plupload-thumbs").prepend('<li class="thumb" id="list_item_'+t.id+'" data-image-id="'+t.id+'"><img src="'+s+'" alt="" /><div class="clear"></div></li>'),jQuery.ajax({data:{action:"fts_edit_image_ajax",id:t.id,postID:jQuery("#img1plupload-thumbs").attr("data-post-id"),nonce:"attach_image"},type:"post",url:ssAjax.ajaxurl,success:function(e){console.log("Well Done and got this from sever: "+e)},error:function(){alert("Error, please contact us at https://slickremix.com/ for help.")}})}))})),a.on("open",(function(){var e=a.state("insert-image").get("selection");e.each((function(t){var a=wp.media.attachment(t.attributes.id);a.fetch(),e.remove(a?[a]:[])}))})),a.open()})),jQuery("div.ft-gallery-popup-form").hasClass("ftg-premium-active")&&jQuery('<div id="ftg-watermark-logo-wrap"></div>').insertAfter("#ft-watermark-image"),e("input#ft-watermark-image").click((function(e){e.preventDefault();var t=wp.media({id:"dgd_featured_image",title:dgd_strings.panel.title,multiple:!1,library:{type:"image"},button:{text:dgd_strings.panel.button}});t.on("select",(function(){var e=t.state().get("selection").first().toJSON();return jQuery("#ft_watermark_image_input").val(e.url),jQuery("#ft_watermark_image_id").val(e.id),jQuery("#ftg-watermark-logo-wrap").html('<img src="'+e.url+'" class="ft-watermark-image-thumb" /><br/>'),jQuery.ajax({data:{action:"fts_update_image_ajax",id:e.id,nonce:e.id,fts_img_remove:"true"},type:"POST",url:ssAjax.ajaxurl,beforeSend:function(){},success:function(e){console.log("Well Done and got this from sever: "+e)},error:function(){alert("Error, please contact us at https://www.slickremix.com/support for help.")}}),!1})),t.open()})),""!==jQuery("#ft-watermark-image").val()&&jQuery("#ftg-watermark-logo-wrap").html('<img src="'+jQuery("#ft_watermark_image_input").val()+'" class="ft-watermark-image-thumb ft-watermark-existing" /><br/>'),e("a.wp-post-thumbnail").live("click",(function(e){parent.tb_remove(),parent.location.reload(1)})),e("a#insert-media-button").live("click",(function(){if("undefined"!=typeof wp){var t=e(".wp-media-buttons:eq(0) .add_media").attr("data-editor"),a=wp.media.editor.get(t);(a=void 0!==a?a:wp.media.editor.add(t))&&a.on("select",(function(){"featured-image"===a.state().id&&doFetchFeaturedImage()}))}})),jQuery("#img1plupload-thumbs").sortable({items:"li",opacity:1,cursor:"move",update:function(){var e=jQuery(this).data("post-id"),t=jQuery(this).sortable("serialize")+"&post_id="+e+"&action=list_update_order";jQuery.post(ajaxurl,t,(function(a){console.log(a),console.log(e),console.log(t)}))}})})),jQuery.fn.exists=function(){return jQuery(this).length>0},jQuery(document).ready((function(e){if(e(".plupload-upload-uic").exists()){var t=!1;e(".plupload-upload-uic").each((function(){var a=e(this),i=a.attr("id").replace("plupload-upload-ui","");if(plu_show_thumbs(i),(t=JSON.parse(JSON.stringify(base_plupload_config))).browse_button=i+t.browse_button,t.container=i+t.container,t.drop_element=t.drop_element,t.file_data_name=i+t.file_data_name,t.multipart_params.imgid=i,t.multipart_params._ajax_nonce=a.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu",""),a.hasClass("plupload-upload-uic-multiple")&&(t.multi_selection=!0),a.find(".plupload-resize").exists()){var r=parseInt(a.find(".plupload-width").attr("id").replace("plupload-width","")),o=parseInt(a.find(".plupload-height").attr("id").replace("plupload-height",""));t.resize={width:r,height:o,quality:100}}var l=new plupload.Uploader(t);l.bind("Init",(function(t){var a=e("#plupload-upload-ui");t.features.dragdrop?(a.addClass("drag-drop"),e("#drag-drop-area").bind("dragover.wp-uploader",(function(){a.addClass("drag-over")})).bind("dragleave.wp-uploader, drop.wp-uploader",(function(){a.removeClass("drag-over")}))):(a.removeClass("drag-drop"),e("#drag-drop-area").unbind(".wp-uploader"))})),l.init(),l.bind("FilesAdded",(function(t,i){e.each(i,(function(e,t){a.find(".filelist").append('<div class="file" id="'+t.id+'"><b>'+t.name+'</b> (<span class="ftg-file-size">'+plupload.formatSize(0)+"</span>/"+plupload.formatSize(t.size)+')  <span class="ftg-finishing"></span><div class="fileprogress"></div></div>')})),t.refresh(),t.start()})),l.bind("UploadProgress",(function(t,a){e("#"+a.id+" .fileprogress").width(a.percent+"%"),e("#"+a.id+" span.ftg-file-size").html(plupload.formatSize(parseInt(a.size*a.percent/100))),setTimeout((function(){100==a.percent&&e("#"+a.id+" span.ftg-finishing").html("<strong>Finishing up, please be patient</strong>")}),5e3)})),l.bind("FileUploaded",(function(t,r,o){if(e("#"+r.id).fadeOut(),e("#"+r.id).addClass("ftg-upload-complete"),o=JSON.parse(o.response),a.hasClass("plupload-upload-uic-multiple")){var l=e.trim(e("#"+i).val());l=o.url,e("#"+i).val(l)}else e("#"+i).val(o.url+"");plu_show_thumbs(i,o.id);var s=jQuery("select#fts_image_to_woo_model_prod").val(),n=jQuery("select#fts_landscape_to_woo_model_prod").val(),d=jQuery("select#fts_square_to_woo_model_prod").val(),u=jQuery("select#fts_portrait_to_woo_model_prod").val(),p=jQuery("#fts_smart_image_orient_prod").is(":checked");if(console.log(s),jQuery("#uploaderSection").hasClass("ftg-auto-create-product-on-upload")||jQuery("#fts_auto_image_woo_prod").is(":checked"))s||n&&d&&u&&p?(fts_image_to_woo_on_upload(o.id,jQuery("#img1plupload-thumbs").attr("data-post-id")),jQuery("#ftg-tab-content1 .ft-gallery-notice").removeClass("error"),jQuery("#ftg-tab-content1 .ft-gallery-notice").removeClass("ftg-block"),jQuery("#ftg-tab-content1 .ft-gallery-notice").html("")):(jQuery("#ftg-tab-content1 .ft-gallery-notice").addClass("error"),jQuery("#ftg-tab-content1 .ft-gallery-notice").addClass("ftg-block"),jQuery("#ftg-tab-content1 .ft-gallery-notice").html(ftg_woo.must_have_option_selected_to_create_products+'<div class="ft-gallery-notice-close"></div>'),console.log("error"));else{var c=jQuery(".file"),m=jQuery(".file.ftg-upload-complete");c.length===m.length&&setTimeout((function(){jQuery("#ftg-tab-content1 .ft-gallery-notice").addClass("updated"),jQuery("#ftg-tab-content1 .ft-gallery-notice").addClass("ftg-block"),jQuery("#ftg-tab-content1 .ft-gallery-notice").html(updatefrombottomParams.images_complete_on_auto_upload),jQuery("#ftg-tab-content1 .ft-gallery-notice").append('<div class="ft-gallery-notice-close"></div>'),console.log("made it")}),500)}}))}))}}));