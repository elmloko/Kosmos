(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[662],{32921:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ChildPages:()=>k,ErrorRenderer:()=>Fe,Logo:()=>Pe,Main:()=>ve,ModuleCard:()=>wt,ModuleFormInputs:()=>pt,Navigation:()=>we,NavigationFill:()=>Ce,NoticeList:()=>je,ONBOARD_STORE_NAME:()=>_r,OnboardBackActionFill:()=>Je,OnboardEmptyMain:()=>rt,OnboardHeader:()=>Ue,OnboardMain:()=>tt,OnboardProgress:()=>st,OnboardSiteTypeBeforeFill:()=>Mr,Page:()=>T,PrimaryForm:()=>De,PrimaryFormSection:()=>Ze,SelectableCard:()=>Re,Sidebar:()=>j,SingleModulePage:()=>an,StatusToggleSettings:()=>dt,history:()=>Vn,useAllowedSettingsFields:()=>Q,useConfigContext:()=>G,useCurrentPage:()=>A,useModuleRequirementsValidator:()=>X,useNavigateTo:()=>K,useNavigation:()=>D,useSettingsForm:()=>Y});var n={};r.r(n),r.d(n,{CLEAR_SITE_TYPE:()=>Gt,CLEAR_VISITED_LOCATIONS:()=>rr,EDIT_ANSWER:()=>Kt,RECEIVE_SITE_TYPE:()=>Ut,RECEIVE_SITE_TYPES:()=>qt,RECORD_VISITED_LOCATION:()=>tr,REGISTER_COMPLETION_STEP:()=>Jt,REGISTER_QUESTION_COMPONENT:()=>Xt,SELECT_SITE_TYPE:()=>Wt,SET_COMPLETION_STEP:()=>er,SET_ERROR:()=>Qt,SET_IS_ANSWERING:()=>Yt,answerQuestion:()=>At,applyAnswerResponse:()=>Dt,clearSiteType:()=>kt,clearVisitedLocations:()=>$t,completeOnboarding:()=>Ft,editAnswer:()=>Mt,receiveSiteType:()=>Ht,receiveSiteTypes:()=>Pt,recordVisitedLocation:()=>zt,registerCompletionStep:()=>Bt,registerQuestionComponent:()=>jt,repeatQuestion:()=>Rt,resetOnboarding:()=>Zt,selectSiteType:()=>Tt});var i={};r.r(i),r.d(i,{getAnswerRequest:()=>pr,getAnswers:()=>sr,getCompletionStep:()=>hr,getCompletionSteps:()=>mr,getEditedAnswer:()=>or,getLastError:()=>dr,getLastVisitedLocation:()=>fr,getNextQuestion:()=>lr,getQuestionComponent:()=>ur,getRestoreSiteTypeRequest:()=>gr,getSelectedSiteType:()=>ar,getSelectedSiteTypeId:()=>ir,getSiteTypes:()=>nr,isAnswering:()=>cr});var a={};r.r(a),r.d(a,{getNextQuestion:()=>vr,getSelectedSiteType:()=>br,getSiteTypes:()=>yr});var s=r(6293),l=r(95122),o=r(25993),c=r.n(o),d=r(79612),u=r(52117),m=r(16550),p=r(42236),g=r(35800),f=r(18526),h=r(64893),E=r(3571),y=r(71930),b=r(92819),v=r(90071),_=r(99196),x=Object.prototype.hasOwnProperty;function w(e,t,r){for(r of e.keys())if(S(r,t))return r}function S(e,t){var r,n,i;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&S(e[n],t[n]););return-1===n}if(r===Set){if(e.size!==t.size)return!1;for(n of e){if((i=n)&&"object"==typeof i&&!(i=w(t,i)))return!1;if(!t.has(i))return!1}return!0}if(r===Map){if(e.size!==t.size)return!1;for(n of e){if((i=n[0])&&"object"==typeof i&&!(i=w(t,i)))return!1;if(!S(n[1],t.get(i)))return!1}return!0}if(r===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(r===DataView){if((n=e.byteLength)===t.byteLength)for(;n--&&e.getInt8(n)===t.getInt8(n););return-1===n}if(ArrayBuffer.isView(e)){if((n=e.byteLength)===t.byteLength)for(;n--&&e[n]===t[n];);return-1===n}if(!r||"object"==typeof e){for(r in n=0,e){if(x.call(e,r)&&++n&&!x.call(t,r))return!1;if(!(r in t)||!S(e[r],t[r]))return!1}return Object.keys(t).length===n}}return e!=e&&t!=t}var C=r(9576),L=r(48015),N=r(31600);const O=(0,s.createContext)({pages:[],childPages:{},addPage:()=>{},removePage:()=>{},addChildPages:()=>{},removeChildPages:()=>{}});function I({children:e}){const[t,r]=(0,s.useState)([]),[n,i]=(0,s.useState)({}),a=(0,s.useCallback)((e=>{r((t=>{const r=t.findIndex((t=>t.id===e.id));let n;return-1===r?n=[...t,e]:(n=[...t],n[r]=e),(0,b.sortBy)(n,"priority")}))}),[]),l=(0,s.useCallback)((e=>{r((t=>t.filter((t=>t.id!==e))))}),[]),o=(0,s.useCallback)(((e,t)=>{i((r=>({...r,[e]:t})))}),[i]),c=(0,s.useCallback)((e=>{i((t=>(0,b.omit)(t,e)))}),[i]);return(0,s.createElement)(O.Provider,{value:{pages:t,childPages:n,addPage:a,removePage:l,addChildPages:o,removeChildPages:c}},e)}function T({id:e,title:t,icon:r,roots:n=["settings"],priority:i=90,location:a="primary",featureFlag:l,ignore:o,hideFromNav:c,children:d}){const u=(0,s.useContext)(O);return(0,s.useEffect)((()=>(u.addPage({id:e,title:t,icon:r,roots:n,priority:i,location:a,featureFlag:l,ignore:o,hideFromNav:c,render:d}),()=>{u.removePage(e)})),[e,t]),null}function k(e){const{pages:t}=e,r=(0,s.useContext)(O),n=(0,C.useInstanceId)(k,"");var i,a,l,o,c;return i=()=>(r.addChildPages(n,t),()=>{r.removeChildPages(n)}),a=[t],_.useEffect(i,(l=a,o=_.useRef(l),c=_.useRef(0),S(l,o.current)||(o.current=l,c.current+=1),_.useMemo((function(){return o.current}),[c.current]))),null}function M({root:e,location:t}={}){const{featureFlags:r}=(0,L.useSelect)((e=>({featureFlags:e(N.CORE_STORE_NAME).getFeatureFlags()})),[]),{root:n}=(0,m.UO)(),{pages:i}=(0,s.useContext)(O);return i.filter((i=>i.roots.includes(e||n)&&(!t||i.location===t)&&(!i.featureFlag||r.includes(i.featureFlag))))}function A(){const e=M(),{page:t}=(0,m.UO)();return e.find((e=>e.id===t))}function R(){const{childPages:e}=(0,s.useContext)(O);return(0,s.useMemo)((()=>(0,b.flatMap)(e)),[e])}function D(e){const{root:t,page:r,child:n,tab:i}=(0,m.UO)(),a=function(e){const t=M();if(!t.length)return;if(!e)return t[0];const r=t.findIndex((t=>t.id===e));return t[r+1]?.id}(r),s=R().map((e=>e.id)),l=(0,m.k6)();let o,c;if(e){let a,s;for(let t=0;t<e.length;t++)if(e[t]===i){a=e[t-1],s=e[t+1];break}o=a&&`/${t}/${r}/${n}/${a}`,c=s&&`/${t}/${r}/${n}/${s}`}if((!o||!c)&&s){let e,i;for(let t=0;t<s.length;t++)if(s[t]===n){e=s[t-1],i=s[t+1];break}o=o||e&&`/${t}/${r}/${e}`,c=c||i&&`/${t}/${r}/${i}`}return!c&&a&&(c=`/${t}/${a}`),{previous:o,goPrevious(){o&&l.push((0,v.ob)(o))},next:c,goNext(){c&&l.push((0,v.ob)(c))},nextPage:a&&`/${t}/${a}`,goNextPage(){a&&l.push((0,v.ob)(`/${t}/${a}`))}}}O.displayName="PageRegistration";var Z=r(73727),F=r(87462),P=r(94184),H=r.n(P),V=r(65813);function j({className:e,logo:t="color",children:r}){const{root:n}=(0,m.UO)(),[i,a]=(0,s.useState)(!1);return(0,s.createElement)("div",(0,F.Z)({},(0,V.Zk)((()=>i&&a(!1))),{tabIndex:-1,className:H()("itsec-settings-sidebar",e,`itsec-settings-sidebar--root-${n}`,{"itsec-settings-sidebar--expanded":i})}),(0,s.createElement)("div",{className:"itsec-settings-sidebar__inner"},(0,s.createElement)(Z.rU,{to:"/",className:"itsec-settings-sidebar__logo"},(0,s.createElement)(Pe,{style:t})),(0,s.createElement)(h.Button,{icon:"menu-alt2",label:(0,l.__)("Toggle Sidebar","better-wp-security"),className:"itsec-settings-sidebar__toggle",showTooltip:!1,isPressed:i,onClick:e=>{e.currentTarget.focus(),a(!i)},"aria-expanded":i}),r))}var B=r(1986),z=r(27231),$=r(36179),q=r(60976),U=r(31511);const W=(0,s.createContext)({serverType:"",installType:"",onboardComplete:!1});function G(){return(0,s.useContext)(W)}function K(){const e=(0,m.k6)();return(0,s.useCallback)(((t,r="push")=>e[r]((0,v.ob)(t))),[e])}function Y(e,t){const{formData:r,conditionalSchemaBase:n}=(0,L.useSelect)((t=>({formData:t(N.MODULES_STORE_NAME).getEditedSettings(e.id),conditionalSchemaBase:t(N.MODULES_STORE_NAME).getSettingsConditionalSchema(e.id)})),[e.id]),{editSettings:i}=(0,L.useDispatch)(N.MODULES_STORE_NAME),a=t?{...n,properties:(0,b.pickBy)(n.properties,t)}:n,s=!(0,b.every)(a?.properties,(e=>"object"===e.type&&(0,b.isEmpty)(e.properties)));return{schema:a,uiSchema:e.settings?.schema.uiSchema,hasSettings:s,formData:r,setFormData:t=>{i(e.id,t.formData)}}}function Q(e){const{root:t}=(0,m.UO)(),r=(()=>{switch(t){case"import":return e?.settings?.import;case"onboard":return e?.settings?.onboard}})(),n=(0,s.useCallback)(((e,t)=>r.includes(t)),[r]);return{allowedFields:r,filterFields:r&&n}}function X(){const{featureFlags:e,siteInfo:t,requirementsInfo:r}=(0,L.useSelect)((e=>({featureFlags:e(N.CORE_STORE_NAME).getFeatureFlags(),siteInfo:e(N.CORE_STORE_NAME).getSiteInfo(),requirementsInfo:e(N.CORE_STORE_NAME).getRequirementsInfo()})),[]);return(0,s.useCallback)(((n,i)=>{const a=new U.PN;if(!n.requirements)return a;const s=e=>e.validate===i||"activate"===i;if(n.requirements.ssl&&s(n.requirements.ssl)&&"https:"!==document.location.protocol&&a.add("ssl",(0,l.__)("Your site must support SSL.","better-wp-security"),n.requirements.ssl),n.requirements["feature-flags"]&&s(n.requirements["feature-flags"]))for(const t of n.requirements["feature-flags"].flags)e.includes(t)||a.add("feature-flags",(0,l.sprintf)((0,l.__)("The '%s' feature flag must be enabled.","better-wp-security"),t),n.requirements["feature-flags"]);if(n.requirements.multisite&&s(n.requirements.multisite)&&("enabled"===n.requirements.multisite.status&&!1===t?.multisite?a.add("multisite",(0,l.__)("Multisite must be enabled.","better-wp-security"),n.requirements.multisite):"disabled"===n.requirements.multisite.status&&!0===t?.multisite&&a.add("multisite",(0,l.__)("Multisite is not supported.","better-wp-security"),n.requirements.multisite)),n.requirements.server&&s(n.requirements.server)&&r){!n.requirements.server.php||(o=r.server.php,c=n.requirements.server.php,o.localeCompare(c,void 0,{numeric:!0,sensitivity:"base"})>=0)||a.add("server",(0,l.sprintf)((0,l.__)("You must be running PHP version %s or later.","better-wp-security"),n.requirements.server.php),n.requirements.server);const e=(n.requirements.server.extensions||[]).filter((e=>!r.server.extensions[e]));1===e.length?a.add("server",(0,l.sprintf)((0,l.__)("The %s PHP extension is required.","better-wp-security"),e[0]),n.requirements.server):e.length>0&&a.add("server",(0,l.sprintf)((0,l._n)("The following PHP extension is required: %l.","The following PHP extensions are required: %l.",e.length,"better-wp-security").replace("%l","%s"),e.join(", ")),n.requirements.server)}var o,c;return n.requirements.load&&s(n.requirements.load)&&r&&("normal"===n.requirements.load.type&&"early"===r.load?a.add("load",(0,l.__)("Loading Solid Security via an MU-Plugin is not supported.","better-wp-security")):"early"===n.requirements.load.type&&"normal"===r.load&&a.add("load",(0,l.__)("Loading Solid Security without an MU-Plugin is not supported.","better-wp-security"))),a}),[e,t,r])}const J=(0,u.Z)("aside",{target:"e1jck2kg4"})("position:relative;display:flex;flex-direction:column;gap:1rem;background:",(({theme:e})=>e.colors.surface.primary),";padding:1rem 2rem 1rem 1.5rem;justify-content:space-between;align-items:center;overflow:hidden;border-radius:0.25rem;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){flex-direction:row;}"),ee=(0,u.Z)("section",{target:"e1jck2kg3"})("display:flex;flex-direction:column;gap:0.625rem;align-items:center;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){align-items:flex-start;}"),te=(0,u.Z)(y.X6,{target:"e1jck2kg2"})("font-size:1.5rem;text-align:center;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){text-align:left;}"),re=(0,u.Z)("a",{target:"e1jck2kg1"})("display:inline-flex;min-width:max-content;padding:0.75rem 1.75rem;justify-content:center;align-items:center;color:#ffffff;font-size:0.83569rem;text-align:center;text-decoration:none;background:#6817C5;&:hover,&:active,&:focus{background-color:#53129e;color:",(({theme:e})=>e.colors.text.white),";}"),ne=(0,u.Z)(h.Button,{target:"e1jck2kg0"})({name:"2ostuf",styles:"position:absolute;top:0;right:0;&:hover,&:active,&:focus{color:#6817c5;}"});function ie(){const[e,t]=(0,V._)("itsecIsSolid"),{installType:r}=G(),n=(0,f.u)(),i=(0,s.useMemo)((()=>({...n,colors:{...n.colors,text:{...n.colors.text,white:"#F9FAF9"}}})),[n]);return e?null:(0,s.createElement)(f.a,{theme:i},(0,s.createElement)(J,null,(0,s.createElement)(q.iO,null),(0,s.createElement)(ee,null,(0,s.createElement)(te,{level:2,weight:700,variant:"dark",size:"extraLarge",text:(0,l.__)("iThemes Security is now Solid Security","better-wp-security")}),(0,s.createElement)(y.xv,{size:"subtitleSmall",weight:500,variant:"dark",text:(0,l.__)("We have been working hard for almost a year to bring you incredible new features in the form of our new and improved brand: SolidWP. Discover what’s new!","better-wp-security")})),(0,s.createElement)($.Xp,null),(0,s.createElement)(ne,{label:(0,l.__)("Dismiss","better-wp-security"),icon:z.Z,onClick:()=>t(!0)}),(0,s.createElement)(re,{href:"pro"===r?"https://go.solidwp.com/settings-notification-ithemes-becoming-solidwp":"https://go.solidwp.com/settings-notification-free-ithemes-becoming-solidwp",weight:600},(0,l.__)("Learn more","better-wp-security"))))}var ae=r(65202);const se=(0,u.Z)("aside",{target:"egcu36m6"})("display:flex;flex-direction:column;position:relative;overflow:hidden;padding:0 2.5rem 0 2.5rem;background:linear-gradient(90deg, #00010C 0%, #8533FF 100%);@media screen and (min-width: ",(({theme:e})=>e.breaks.small),"px){flex-direction:row;justify-content:space-between;gap:60px;}"),le=(0,u.Z)("div",{target:"egcu36m5"})("display:flex;flex-direction:column;align-items:flex-start;justify-content:center;gap:0.5rem;margin-top:2.5rem;@media screen and (min-width: ",(({theme:e})=>e.breaks.small),"px){margin-top:0;}"),oe=(0,u.Z)(y.X6,{target:"egcu36m4"})({name:"dvodxn",styles:"font-size:1.625rem;font-family:'PolySans',sans-serif"}),ce=(0,u.Z)(y.xv,{target:"egcu36m3"})({name:"1fmf7g3",styles:"font-size:1.375rem;line-height:1.5rem;font-family:'PolySans',sans-serif"}),de=(0,u.Z)(h.Button,{target:"egcu36m2"})({name:"jfp1m3",styles:"height:47px;width:200px;margin-top:1.25rem;padding:15px 20px;justify-content:center;font-size:1rem;border-radius:50px;background:#F9FAF9;color:#8533FF"}),ue=(0,u.Z)(q.fX,{target:"egcu36m1"})("max-width:245px;margin-top:2rem;margin-right:-1rem;align-self:flex-end;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){margin-top:2rem;}@media screen and (min-width: ",(({theme:e})=>e.breaks.xlarge),"px){margin-top:1.25rem;margin-right:90px;}"),me=(0,u.Z)(h.Button,{target:"egcu36m0"})({name:"1owrvd2",styles:"position:absolute;top:2px;right:2px;&:hover,&:active,&:focus{color:#6817c5;}& svg{background:white;border-radius:25px;}"}),pe=Date.UTC(2023,10,20,0,0,0),ge=Date.UTC(2023,11,4,9,59,59),fe=Date.now();function he(){const[e,t]=(0,V._)("solidSecurityBFCM2023"),{installType:r}=G(),n=(0,f.u)(),i=(0,s.useMemo)((()=>({...n,colors:{...n.colors,text:{...n.colors.text,white:"#F9FAF9"}}})),[n]);return pe>fe||ge<fe||e?null:(0,s.createElement)(f.a,{theme:i},(0,s.createElement)(se,null,(0,s.createElement)(le,null,(0,s.createElement)(oe,{level:2,variant:y.rK.WHITE,weight:y.fs.HEAVY,text:(0,l.__)("Save 40% on SolidWP","better-wp-security")}),(0,s.createElement)(ce,{variant:y.rK.WHITE,text:(0,l.__)("Purchase new products during the Black Friday Sale.")}),(0,s.createElement)(de,{href:"free"===r?"https://go.solidwp.com/bfcm-go-pro":"https://go.solidwp.com/bfcm-security-pro-solid-suite",weight:500},(0,l.__)("Get Solid Suite","better-wp-security"))),(0,s.createElement)(me,{label:(0,l.__)("Dismiss","better-wp-security"),icon:ae.Z,onClick:()=>t(!0)}),(0,s.createElement)(ue,null)))}const Ee=(0,u.Z)("div",{target:"e1pas7nv2"})({name:"vgwucc",styles:"display:flex;align-self:center;flex-direction:column;gap:1.25rem;width:100%;max-width:1680px;padding:1.25rem 1.25rem 4rem 1.5rem"}),ye=(0,u.Z)("main",{target:"e1pas7nv1"})({name:"bjn8wh",styles:"position:relative"}),be=(0,u.Z)(h.FlexItem,{target:"e1pas7nv0"})("margin-top:",(({isMedium:e})=>e&&"1.25rem"),";width:",(({isMedium:e})=>e&&"10rem"),";");function ve({children:e}){const t=(0,C.useViewportMatch)("medium"),r=(0,s.useRef)(),n=(0,m.TH)();return(0,s.useEffect)((()=>{r.current?.focus(),r.current?.ownerDocument.body.scrollTo(0,0)}),[n]),(0,s.createElement)(React.Fragment,null,(0,s.createElement)(B.Qf,null),(0,s.createElement)(Ee,null,(0,s.createElement)(ie,null),(0,s.createElement)(he,null),(0,s.createElement)(y.X6,{level:1,text:(0,l.__)("Settings","better-wp-security"),weight:y.fs.NORMAL}),(0,s.createElement)(h.Flex,{gap:5,align:"start",direction:t?"row":"column"},(0,s.createElement)(be,{isMedium:t},(0,s.createElement)(we,{orientation:t?"vertical":"horizontal"})),(0,s.createElement)(h.FlexBlock,null,(0,s.createElement)(ye,{ref:r,"aria-labelledby":"itsec-page-header"},(0,s.createElement)(g.ErrorBoundary,{FallbackComponent:Fe},e))))))}const _e=(0,u.Z)(y.aV,{target:"eq1p6lg1"})({name:"vtxs8z",styles:"margin:1rem"}),xe=(0,u.Z)(y.xv,{target:"eq1p6lg0"})("text-decoration:none;&.active{color:",(({theme:e})=>e.colors.primary.darker20),";}");function we({orientation:e,children:t}){const r=M({location:"primary"}),{root:n,page:i}=(0,m.UO)();return(0,s.createElement)(y.Rx,{orientation:e},r.map((e=>(0,s.createElement)(s.Fragment,{key:e.id},(0,s.createElement)(Z.OL,{key:e.id,to:`/${n}/${e.id}`,component:(0,V.Sj)(y.Ig)},e.title),e.id===i&&(0,s.createElement)(Se,null)))),t)}function Se(){const e=R();return e.length?(0,s.createElement)(_e,{gap:3},e.map((({title:e,to:t,id:r})=>(0,s.createElement)(y.HC,{key:r},(0,s.createElement)(Z.OL,{to:t,component:(0,V.Sj)(xe),as:"a",text:e,variant:y.rK.MUTED}))))):null}const{Fill:Ce}=(0,h.createSlotFill)("Navigation");var Le=r(63708);const Ne=(0,u.Z)("button",{target:"e1bc0q4r6"})("text-decoration:none;margin:0;border:0;padding:0;cursor:pointer;-webkit-appearance:none;background:none;width:100%;&:focus{box-shadow:0 0 0 var(--wp-admin-border-width-focus) ",(({theme:e})=>e.colors.primary.base),";outline:3px solid transparent;}"),Oe=(0,u.Z)(y.X6,{target:"e1bc0q4r5"})({name:"1ce9wo2",styles:"grid-area:title"}),Ie=(0,u.Z)(y.xv,{target:"e1bc0q4r4"})({name:"1x9glg",styles:"grid-area:description"}),Te=(0,u.Z)(y.Tg,{target:"e1bc0q4r3"})({name:"imqah0",styles:"grid-area:icon;width:4rem;height:3.25rem;display:flex;align-items:center;justify-content:center;border-radius:2px"}),ke=(0,u.Z)(h.Icon,{target:"e1bc0q4r2"})({name:"18b7ufz",styles:"fill:#9675F7"}),Me=(0,u.Z)(h.Icon,{target:"e1bc0q4r1"})({name:"1e03zz3",styles:"grid-area:go;align-self:center"}),Ae=(0,u.Z)("div",{target:"e1bc0q4r0"})("background:#f6f7f7;border:1px solid ",(({theme:e})=>e.colors.border.normal),";border-radius:2px;display:",(({direction:e})=>"horizontal"===e?"grid":"flex"),";flex-direction:column;align-items:",(({direction:e})=>"vertical"===e&&"center"),";justify-content:",(({direction:e})=>"vertical"===e&&"center"),';grid-template-areas:"icon title go" "icon description go";grid-template-columns:min-content auto min-content;gap:',(({direction:e})=>"horizontal"===e?"0.5rem 1.25rem":"0.75rem"),";padding:1rem;min-height:",(({direction:e})=>"vertical"===e&&"200px"),";&:hover ",Me,"{fill:",(({theme:e})=>e.colors.primary.darker20),";}&:hover ",Oe,"{color:",(({theme:e})=>e.colors.primary.darker20),";}");function Re({onClick:e,title:t,description:r,icon:n,direction:i="horizontal",className:a,disabled:l}){return(0,s.createElement)(Ne,{onClick:e,className:a,variant:"none",disabled:l},(0,s.createElement)(Ae,{direction:i},(0,s.createElement)(Te,{variant:y.h1.SECONDARY},(0,s.createElement)(ke,{icon:n,size:30})),(0,s.createElement)(Oe,{level:4,size:y.yH.LARGE,weight:y.fs.HEAVY,text:t}),r&&(0,s.createElement)(Ie,{variant:y.rK.MUTED,text:r,align:"vertical"===i?"center":"left"}),"horizontal"===i&&(0,s.createElement)(Me,{icon:Le.Z})))}function De({onSubmit:e=(()=>{}),id:t,hasPadding:r,children:n,errors:i,apiError:a,className:l}){const o=(0,C.useInstanceId)(De,"itsec-primary-form");return t=t||o,(0,s.createElement)("div",{className:H()("itsec-primary-form",l,r&&"itsec-primary-form--has-padding")},(0,s.createElement)(B.KM,{errors:i,apiError:a}),(0,s.createElement)("form",{id:t,onSubmit:t=>{t.preventDefault(),e()}},n))}function Ze({heading:e,className:t,children:r}){return s.Children.toArray(r).some(s.isValidElement)?(0,s.createElement)("div",{className:H()("itsec-primary-form__section",t)},e&&(0,s.createElement)(y.X6,{level:3,variant:y.rK.DARK,size:y.yH.NORMAL,weight:y.fs.HEAVY,className:"itsec-primary-form__section-title"},e),r):null}function Fe({error:e}){const{pathname:t}=(0,m.TH)();return(0,s.createElement)(h.Card,{className:"itsec-error-renderer"},(0,s.createElement)(h.CardBody,null,(0,s.createElement)(B.nU,{icon:(0,s.createElement)(q.gI,null)})),(0,s.createElement)(h.CardFooter,{isShady:!0},(0,l.__)("An unexpected error occurred.","better-wp-security"),(0,s.createElement)($.Xp,null),(0,s.createElement)(h.Button,{variant:"secondary",onClick:()=>window.location.reload()},(0,l.__)("Refresh","better-wp-security")),(0,s.createElement)(h.ClipboardButton,{variant:"primary",text:`Page: ${t}\nError: ${e.stack}`},(0,l.__)("Copy Error","better-wp-security"))))}function Pe({style:e,className:t}){const{installType:r}=G();let n;return n="pro"===r?"white"===e?q.v5:q.Zj:"white"===e?q.CE:q.D5,(0,s.createElement)(n,{className:t})}var He=r(25703);const Ve=(0,u.Z)(h.SnackbarList,{target:"e1ifekm20"})("top:",(({root:e})=>"settings"===e?"-70px":"-10px"),";.components-snackbar-list__notice-container{display:flex;flex-direction:column;align-items:flex-end;}");function je({context:e="ithemes-security"}){const{notices:t}=(0,L.useSelect)((t=>({notices:t(He.store).getNotices(e)})),[e]),{removeNotice:r}=(0,L.useDispatch)(He.store),n=t=>r(t,e),{root:i}=(0,m.UO)(),a=(0,b.filter)(t,(e=>e.isDismissible&&(!e.type||"default"===e.type))),l=(0,b.filter)(t,(e=>!(e.isDismissible||e.type&&"default"!==e.type))),o=(0,b.filter)(t,{type:"snackbar"});return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(h.NoticeList,{notices:l}),(0,s.createElement)(h.NoticeList,{notices:a,onRemove:n}),(0,s.createElement)(Ve,{root:i,notices:o,onRemove:n}))}const Be=(0,u.Z)("header",{target:"e142nzcb3"})({name:"9hhwv0",styles:'display:grid;grid-template-areas:"title action" "description action";grid-gap:0.5rem 1rem;margin-bottom:1.5rem'}),ze=(0,u.Z)(y.X6,{target:"e142nzcb2"})({name:"5uk9le",styles:"grid-area:title;display:flex;gap:0.5rem"}),$e=(0,u.Z)(y.xv,{target:"e142nzcb1"})({name:"1x9glg",styles:"grid-area:description"}),qe=(0,u.Z)(y.zx,{target:"e142nzcb0"})({name:"5xe988",styles:"grid-area:action;align-self:end;justify-self:end"});function Ue({title:e,description:t,showIndicator:r,showNext:n}){const{page:i}=(0,m.UO)(),{goNext:a}=D(),o=M({location:"primary"}).filter((({hideFromNav:e})=>!e)).findIndex((({id:e})=>e===i))+1;return(0,s.createElement)(Be,null,(0,s.createElement)(ze,{level:2,size:y.yH.EXTRA_LARGE,variant:y.rK.DARK,text:e},o&&r&&(0,s.createElement)(y.OR,{step:o,surfaceVariant:y.h1.PRIMARY_ACCENT,textSize:y.yH.NORMAL})),(0,s.createElement)($e,{as:"p",variant:y.rK.MUTED,text:t}),n&&(0,s.createElement)(qe,{onClick:a,variant:"secondary",text:(0,l.__)("Next","better-wp-security")}))}var We=r(52278);const Ge=(0,u.Z)(y.Tg,{target:"eh4epfs3"})({name:"1xqx6nt",styles:"position:relative;height:auto;flex-grow:1;display:flex;flex-direction:column;align-items:start;gap:2rem;padding:1.25rem"}),Ke=(0,u.Z)("main",{target:"eh4epfs2"})({name:"66fm4m",styles:"position:relative;width:100%;align-self:center;display:flex;flex-direction:column;flex-grow:1;align-items:center;justify-content:center"}),Ye=(0,u.Z)(Xe,{target:"eh4epfs1"})({name:"1uuv4to",styles:"position:absolute;top:0;right:0;pointer-events:none"}),Qe=(0,u.Z)(B.TR,{target:"eh4epfs0"})({name:"19c0s48",styles:"height:44px;width:auto"});function Xe({className:e}){return(0,s.createElement)("svg",{className:e,width:"579",height:"503",viewBox:"0 0 579 503",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("g",{opacity:"0.6",filter:"url(#filter0_bf_5527_127309)"},(0,s.createElement)("ellipse",{cx:"579",cy:"-56.5",rx:"259",ry:"239.5",fill:"#53129E"})),(0,s.createElement)("defs",null,(0,s.createElement)("filter",{id:"filter0_bf_5527_127309",x:"0",y:"-616",width:"1158",height:"1119",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},(0,s.createElement)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,s.createElement)("feGaussianBlur",{in:"BackgroundImageFix",stdDeviation:"20"}),(0,s.createElement)("feComposite",{in2:"SourceAlpha",operator:"in",result:"effect1_backgroundBlur_5527_127309"}),(0,s.createElement)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_backgroundBlur_5527_127309",result:"shape"}),(0,s.createElement)("feGaussianBlur",{stdDeviation:"160",result:"effect2_foregroundBlur_5527_127309"}))))}const{Fill:Je,Slot:et}=(0,h.createSlotFill)("OnboardBackAction");function tt({url:e,render:t}){const{page:r}=(0,m.UO)(),n=function(e){const t=M();if(!t.length)return;if(!e)return;const r=t.findIndex((t=>t.id===e));return t[r-1]?.id}(r),{pathname:i}=(0,m.TH)();return(0,s.createElement)(Ge,null,(0,s.createElement)(Ye,null),"/onboard/site-type"!==i&&"/onboard/summary"!==i&&(0,s.createElement)(React.Fragment,null,(0,s.createElement)(Qe,null),(0,s.createElement)(et,null,(t=>t.length>0?t:(0,s.createElement)(Z.rU,{to:n?`${e}/${n}`:e,component:(0,V.Sj)(y.zx),text:(0,l.__)("Back","better-wp-security"),icon:We.Z,iconPosition:"left",variant:"tertiary"})))),(0,s.createElement)(Ke,null,(0,s.createElement)(je,null),(0,s.createElement)(t,null)),(0,s.createElement)(st,null))}function rt(){return(0,s.createElement)(Ge,null,(0,s.createElement)(Ke,null))}const nt=(0,u.Z)("div",{target:"e15ke12s2"})({name:"1jx74mh",styles:"display:flex;flex-direction:column;align-items:center;gap:0.5rem;margin-top:auto;align-self:center"}),it=(0,u.Z)("ul",{target:"e15ke12s1"})({name:"1ik4a25",styles:"display:flex;gap:1.5rem;justify-content:center;align-items:center;margin:0;padding:0"}),at=(0,u.Z)(y.xv,{target:"e15ke12s0"})({name:"b49vxh",styles:"display:inline-flex;align-items:center;gap:0.25rem"});function st({className:e}){const{page:t}=(0,m.UO)(),r=(0,C.useViewportMatch)("medium"),n=M({location:"primary"}).filter((({hideFromNav:e})=>!e));return n.find((({id:e})=>e===t))?(0,s.createElement)(nt,{className:e},(0,s.createElement)(it,null,n.map(((e,i)=>(r||e.id===t||n[i-1]?.id===t)&&(0,s.createElement)(at,{key:e.id,as:"li",decoration:"none",weight:t===e.id?y.fs.HEAVY:y.fs.NORMAL,variant:t===e.id?y.rK.DARK:y.rK.MUTED},(0,s.createElement)(y.OR,{step:i+1,textSize:y.yH.NORMAL,surfaceVariant:t===e.id?y.h1.PRIMARY_ACCENT:y.h1.SECONDARY}),e.title)))),!r&&(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:(0,l.sprintf)((0,l.__)("out of %d","better-wp-security"),n.length)})):null}var lt=r(36058),ot=r(96015),ct=r(83904);function dt({module:e,setSettingsOpen:t,persist:r}){const n="active"===e.status.selected,[i,a]=(0,s.useState)(!1),{activateModule:o,deactivateModule:c,editModule:d}=(0,L.useDispatch)(N.MODULES_STORE_NAME);return(0,s.createElement)(h.ToggleControl,{label:e.title,checked:n,onChange:async n=>{a(!0),n?(await(r?o(e.id):d(e.id,{status:{selected:"active"}})),t(!0)):await(r?c(e.id):d(e.id,{status:{selected:"inactive"}})),a(!1)},disabled:i,"aria-label":(0,l.sprintf)((0,l.__)("Enable the “%s” module.","better-wp-security"),e.title),"aria-describedby":`itsec-module-description--${e.id}`,__nextHasNoMarginBottom:!0})}const ut=(0,u.Z)(B.KM,{target:"e1fdddvi1"})({name:"1102gqn",styles:"margin:0 1.5rem 1rem"}),mt=(0,u.Z)(B.b,{target:"e1fdddvi0"})({name:"1traxmt",styles:"& .itsec-rjsf-object-fieldset>.form-group,& .itsec-rjsf-object-fieldset>.itsec-rjsf-section-title{padding:0 1.5rem;}"});function pt({module:e,schema:t,uiSchema:r,formData:n,setFormData:i,highlightedSetting:a}){const l=(0,C.useInstanceId)(pt,`itsec-configure-${e.id}`),{apiError:o}=(0,L.useSelect)((t=>({apiError:t(N.MODULES_STORE_NAME).getError(e.id)})),[e.id]),c=(0,s.useMemo)((()=>{return a?(e=r?(0,b.cloneDeep)(r):{},t=[a,"classNames"],"itsec-highlighted-search-result",(0,b.set)(e,t,H()((0,b.get)(e,t),"itsec-highlighted-search-result")),e):r;var e,t}),[r,a]),d=(0,s.useMemo)((()=>({module:e.id,disableInlineErrors:!0})),[e.id]);return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(ut,{apiError:o}),(0,s.createElement)(mt,{tagName:"div",id:l,schema:t,uiSchema:c,formData:n,onChange:i,idPrefix:`itsec_${e.id}`,formContext:d,showErrorList:!1}))}const gt=(0,u.Z)("section",{target:"ecf3scj8"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";box-shadow:",(({theme:e,isHighlighted:t})=>t&&`0 0 0 var(--wp-admin-border-width-focus) ${e.colors.primary.base}`),";"),ft=(0,u.Z)("header",{target:"ecf3scj7"})("padding:1.25rem 1rem;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";display:flex;align-items:center;justify-content:space-between;"),ht=(0,u.Z)("div",{target:"ecf3scj6"})({name:"1dvcxr3",styles:"padding:1rem"}),Et=(0,u.Z)("button",{target:"ecf3scj5"})({name:"1jnezc0",styles:'display:grid;grid-template-areas:"title graphic" "description graphic";grid-template-columns:auto min-content;align-items:center;gap:0.5rem;width:100%;padding:1rem;cursor:pointer;background-color:transparent;border-width:0;&[disabled]{cursor:default;}'}),yt=(0,u.Z)(y.xv,{target:"ecf3scj4"})({name:"1ce9wo2",styles:"grid-area:title"}),bt=(0,u.Z)(y.xv,{target:"ecf3scj3"})({name:"1x9glg",styles:"grid-area:description"}),vt=(0,u.Z)(h.Icon,{target:"ecf3scj2"})({name:"rkr399",styles:"grid-area:graphic"}),_t=(0,u.Z)("div",{target:"ecf3scj1"})("display:",(({isOpen:e})=>e?"block":"none"),";padding:1rem 0;background:#f6f7f7;"),xt=(0,u.Z)("div",{target:"ecf3scj0"})({name:"l7eclt",styles:"padding:0 1rem 1rem"});function wt({module:e,isHighlighted:t,highlightedSetting:r,persistStatus:n}){const[i,a]=(0,s.useState)(!1),o="active"===e.status.selected,c=X()(e,o?"run":"activate"),{allowedFields:d,filterFields:u}=Q(e),{schema:m,uiSchema:p,hasSettings:g,formData:f,setFormData:h}=Y(e,u);if(!o&&c.hasErrors()&&!c.getErrorCodes().some((e=>c.getErrorData(e)[0].showMessageIfUnmet)))return null;if("always-active"===e.status.default&&!g)return null;const E="always-active"!==e.status.default&&!c.hasErrors(),b=!(!e.settings?.show_ui||c.hasErrors()||Array.isArray(d)&&!d.length),v=i||t;return(0,s.createElement)(gt,{isHighlighted:t},(0,s.createElement)(ft,null,E&&(0,s.createElement)(dt,{module:e,setSettingsOpen:a,persist:n}),!E&&(0,s.createElement)(y.xv,{text:e.title}),(0,s.createElement)(y.zx,{icon:lt.Z,label:(0,l.__)("View external documentation.","better-wp-security"),href:"https://go.solidwp.com/security-basic-help-docs",target:"_blank",variant:"tertiary",isSmall:!0})),!b&&(0,s.createElement)(ht,null,(0,s.createElement)(y.xv,{size:y.yH.SMALL},(0,s.createElement)(B.Lu,{noWrap:!0,content:e.description}))),b&&(0,s.createElement)(Et,{onClick:()=>a(!i),"aria-expanded":v,"aria-controls":`itsec-module-settings-${e.id}`,disabled:!o,type:"button"},(0,s.createElement)(yt,{text:(0,l.sprintf)((0,l.__)("%s Settings","better-wp-security"),e.title)}),(0,s.createElement)(bt,{text:e.description,size:y.yH.SMALL}),o&&b&&(0,s.createElement)(vt,{icon:v?ot.Z:ct.Z})),o&&b&&(0,s.createElement)(_t,{isOpen:v,variant:y.h1.PRIMARY_CONTRAST,id:`itsec-module-settings-${e.id}`},(0,s.createElement)(pt,{module:e,schema:m,uiSchema:p,formData:f,setFormData:h,highlightedSetting:r})),c.hasErrors()&&(0,s.createElement)(xt,null,(0,s.createElement)(B.KM,{errors:c.getAllErrorMessages()})))}var St=r(87514),Ct=r.n(St),Lt=r(54761);function Nt(e){return{type:"API_FETCH",request:e}}function Ot(e,...t){return{type:"DO_ACTION",action:e,args:t}}const It={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},DO_ACTION:(0,L.createRegistryControl)((e=>({action:t,args:r})=>{(0,Lt.doAction)(`ithemes-security.${t}`,e,...r)})),API_FETCH:({request:e})=>Ct()(e).catch(U.xJ),CREATE_NOTICE:(0,L.createRegistryControl)((e=>({status:t,content:r,options:n})=>{n.autoDismiss&&(n.id=n.id||(0,b.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>e.dispatch("core/notices").removeNotice(n.id,n.context)),n.autoDismiss)),e.dispatch("core/notices").createNotice(t,r,n)}))};function*Tt(e){const t=yield L.controls.resolveSelect(_r,"getSiteTypes"),r=(0,b.find)(t,(t=>t.id===e));if(!r)throw(0,l.__)("No site type found with that id.","better-wp-security");yield Ht(r),yield Zt()}function kt(){return{type:Gt}}function Mt(e){return{type:Kt,answer:e}}function*At(e){const t=yield L.controls.select(_r,"getAnswerRequest",e);let r;yield Vt();try{r=yield Nt({method:"PUT",path:`/ithemes-security/v1/site-types/${t.id}`,data:t}),yield Ht(r)}catch(e){yield(n=e,{type:Qt,error:n})}var n;yield Vt(!1)}function*Rt(){const e=yield L.controls.select(_r,"getRestoreSiteTypeRequest");e.answers.pop(),yield Vt();const t=yield Nt({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield Ht(t),yield Vt(!1)}function*Dt(){const e=yield L.controls.select(_r,"getAnswers"),t=yield L.controls.resolveSelect(N.MODULES_STORE_NAME,"getModules");for(const r of e){for(const e of r.modules){const r=t.find((({id:t})=>t===e));r?.side_effects?yield L.controls.dispatch(N.MODULES_STORE_NAME,"activateModule",e):yield L.controls.dispatch(N.MODULES_STORE_NAME,"editModule",e,{status:{selected:"active"}})}for(const e in r.settings)r.settings.hasOwnProperty(e)&&(yield L.controls.dispatch(N.MODULES_STORE_NAME,"editSettings",e,r.settings[e]));yield Ot("onboard.applyAnswerResponse",r)}}function*Zt(){yield Mt(null),yield L.controls.dispatch(N.MODULES_STORE_NAME,"resetModuleEdits"),yield L.controls.dispatch(N.MODULES_STORE_NAME,"resetSettingEdits"),yield Ot("onboard.reset")}function*Ft({root:e}){const t=e=>{if(e instanceof Error)throw e},r=(0,b.sortBy)(yield L.controls.select(_r,"getCompletionSteps"),"priority");try{for(const a of r){if(a.activeCallback&&!a.activeCallback({root:e}))continue;yield{type:er,step:a};const r=a.callback();r instanceof Promise&&t(yield(n=r,i=(0,b.random)(1500,2500),{type:"AWAIT_PROMISE",promise:n,delay:i}))}yield L.controls.dispatch(N.MODULES_STORE_NAME,"editSetting","global","onboard_complete",!0),yield L.controls.dispatch(N.MODULES_STORE_NAME,"saveSettings","global"),yield{type:er,step:!0}}catch(e){yield{type:er,step:!1},yield function(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}("error",(0,l.sprintf)((0,l.__)("Could not complete setup: %s","better-wp-security"),e.message))}var n,i}function Pt(e){return{type:qt,siteTypes:e}}function Ht(e){return{type:Ut,siteType:e}}function Vt(e=!0){return{type:Yt,isAnswering:e}}function jt(e,t){return{type:Xt,id:e,component:t}}function Bt({id:e,label:t,priority:r,callback:n,activeCallback:i}){return{type:Jt,id:e,label:t,priority:r,callback:n,activeCallback:i}}function zt(e){return{type:tr,location:(0,b.trimEnd)(e,"/")}}function $t(){return{type:rr}}const qt="RECEIVE_SITE_TYPES",Ut="RECEIVE_SITE_TYPE",Wt="SELECT_SITE_TYPE",Gt="CLEAR_SITE_TYPE",Kt="EDIT_ANSWER",Yt="SET_IS_ANSWERING",Qt="SET_ERROR",Xt="REGISTER_QUESTION_COMPONENT",Jt="REGISTER_COMPLETION_STEP",er="SET_COMPLETION_STEP",tr="RECORD_VISITED_LOCATION",rr="CLEAR_VISITED_LOCATIONS";function nr(e){return e.siteTypes}function ir(e){return e.selectedSiteType}function ar(e){return(0,b.find)(nr(e),{id:ir(e)})}function sr(e){return e.answers}function lr(e){return e.nextQuestion}function or(e){return e.editedAnswer}function cr(e){return e.isAnswering}function dr(e){return e.lastError}function ur(e,t){return e.questionComponents[t]}function mr(e){return e.completionSteps}function pr(e,t){return{id:e.selectedSiteType,answers:[...e.answers,{question:e.nextQuestion.id,answer:t}]}}function gr(e){return{id:e.selectedSiteType,answers:[...e.answers]}}function fr(e){const t=["/onboard","/onboard/site-type"];for(let r=e.visitedLocations.length-1;r>=0;r--){const n=e.visitedLocations[r];if(!t.includes(n))return n}}function hr(e){return e.completionStep}const Er={siteTypes:[],selectedSiteType:"",answers:[],nextQuestion:void 0,editedAnswer:void 0,lastError:void 0,isAnswering:!1,questionComponents:{},completionStep:!1,completionSteps:{},visitedLocations:[]},yr={*fulfill(){const e=yield Nt({path:"/ithemes-security/v1/site-types"});yield Pt(e)},isFulfilled:e=>e.siteTypes.length>0},br={*fulfill(){yield L.controls.resolveSelect(_r,"getSiteTypes")},isFulfilled:e=>e.siteTypes.length>0},vr={*fulfill(){const e=yield L.controls.select(_r,"getRestoreSiteTypeRequest"),t=yield Nt({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield Ht(t)},isFulfilled:e=>void 0!==e.nextQuestion},_r="ithemes-security/onboard";(0,L.registerStore)(_r,{controls:It,actions:n,selectors:i,resolvers:a,reducer:function(e=Er,t){switch(t.type){case qt:return{...e,siteTypes:t.siteTypes};case Ut:return{...e,selectedSiteType:t.siteType.id,nextQuestion:t.siteType.next_question,answers:t.siteType.answers,editedAnswer:t.siteType.next_question?.answer_schema?.default,lastError:void 0};case Wt:return{...e,selectedSiteType:t.id,answers:[],nextQuestion:void 0,lastError:void 0};case Gt:return{...e,selectedSiteType:"",answers:[],nextQuestion:void 0,lastError:void 0};case Kt:return{...e,editedAnswer:t.answer};case Yt:return{...e,isAnswering:t.isAnswering};case Qt:return{...e,lastError:t.error};case er:return{...e,completionStep:t.step};case Xt:return{...e,questionComponents:{...e.questionComponents,[t.id]:t.component}};case Jt:return{...e,completionSteps:{...e.completionSteps,[t.id]:(0,b.omit)(t,["type"])}};case tr:return{...e,visitedLocations:(0,b.last)(e.visitedLocations)===t.location?e.visitedLocations:(0,b.without)(e.visitedLocations,t.location).concat(t.location)};case rr:return{...e,visitedLocations:[]};default:return e}},persist:["selectedSiteType","answers","visitedLocations"]});const xr=(0,u.Z)("div",{target:"e16j7rt12"})({name:"1nnaomw",styles:"display:flex;flex-direction:column;gap:1.25rem;max-width:670px"}),wr=(0,u.Z)(B.TR,{target:"e16j7rt11"})({name:"aerlcf",styles:"height:44px;width:auto;align-self:start"}),Sr=(0,u.Z)("header",{target:"e16j7rt10"})({name:"p5tmle",styles:"display:flex;flex-direction:column;gap:0.5rem"}),Cr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M9 4C8.44531 4 8 4.44531 8 5V6H3C2.44531 6 2 6.44531 2 7V23C2 23.5547 2.44531 24 3 24H8V25C8 25.5547 8.44531 26 9 26H23C23.5547 26 24 25.5547 24 25V24H29C29.5547 24 30 23.5547 30 23V7C30 6.44531 29.5547 6 29 6H24V5C24 4.44531 23.5547 4 23 4H9ZM10 6H22V24H10V6ZM4 8H8V22H4V8ZM12 8V10H20V8H12ZM24 8H28V22H24V8ZM12 12V14H20V12H12ZM12 16V18H20V16H12ZM12 20V22H20V20H12Z",fill:"#9675F7"})),Lr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("g",{clipPath:"url(#clip0_5527_131266)"},(0,s.createElement)("path",{d:"M8.94922 4C7.30416 4 5.94922 5.35494 5.94922 7V25C5.94922 26.6451 7.30416 28 8.94922 28H14V26H8.94922C8.38628 26 7.94922 25.5629 7.94922 25V7C7.94922 6.43706 8.38628 6 8.94922 6H17.9492V12H23.9492V14H25.9492V10.5859L19.3633 4H8.94922ZM19.9492 7.41406L22.5352 10H19.9492V7.41406ZM28.3633 16.0078C27.7056 16.012 27.0494 16.2678 26.5586 16.7695L17.3125 26.1758L15.9023 32.1016L21.8242 30.6914L22.0234 30.4961L31.2344 21.4492C32.2423 20.4642 32.2502 18.8167 31.2539 17.8203L30.1836 16.75C29.685 16.2514 29.0239 16.0036 28.3633 16.0078ZM28.375 17.9961C28.5143 17.9952 28.6561 18.0506 28.7695 18.1641L29.8398 19.2344C30.0634 19.458 30.0641 19.7966 29.8359 20.0195V20.0234L20.8242 28.8711L18.6016 29.4023L19.1289 27.1836L27.9844 18.1719L27.9883 18.168C28.0988 18.0542 28.2357 17.997 28.375 17.9961Z",fill:"#9675F7"})),(0,s.createElement)("defs",null,(0,s.createElement)("clipPath",{id:"clip0_5527_131266"},(0,s.createElement)("rect",{width:"32",height:"32",fill:"white"})))),Nr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M8 0C6.90625 0 6 0.90625 6 2V11C6 11.5547 6.44531 12 7 12H23C23.5547 12 24 11.5547 24 11V2C24 0.90625 23.0938 0 22 0H8ZM8 4H22V10H8V4ZM8.46875 14L4.86719 20H7.20313L10.7969 14H8.46875ZM14 14V20H16V14H14ZM19.2031 14L22.8047 20H25.1328L21.5312 14H19.2031ZM2 22C0.898438 22 0 22.8984 0 24V28C0 29.1016 0.898438 30 2 30H6C7.10156 30 8 29.1016 8 28V24C8 22.8984 7.10156 22 6 22H2ZM12 22C10.8984 22 10 22.8984 10 24V28C10 29.1016 10.8984 30 12 30H18C19.1016 30 20 29.1016 20 28V24C20 22.8984 19.1016 22 18 22H12ZM24 22C22.8984 22 22 22.8984 22 24V28C22 29.1016 22.8984 30 24 30H28C29.1016 30 30 29.1016 30 28V24C30 22.8984 29.1016 22 28 22H24ZM2 24H6V28H2V24ZM12 24H18V28H12V24ZM24 24H28V28H24V24Z",fill:"#9675F7"})),Or=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M13 2C11.3549 2 10 3.35494 10 5V6H5C3.35494 6 2 7.35494 2 9V25C2 26.6451 3.35494 28 5 28H27C28.6451 28 30 26.6451 30 25V9C30 7.35494 28.6451 6 27 6H22V5C22 3.35494 20.6451 2 19 2H13ZM13 4H19C19.5629 4 20 4.43706 20 5V6H12V5C12 4.43706 12.4371 4 13 4ZM5 8H27C27.5629 8 28 8.43706 28 9V25C28 25.5629 27.5629 26 27 26H5C4.43706 26 4 25.5629 4 25V9C4 8.43706 4.43706 8 5 8ZM16 10C14.75 10 13.6872 10.5048 13.0039 11.2734C12.3206 12.0421 12 13.0278 12 14C12 14.9722 12.3206 15.9579 13.0039 16.7266C13.1446 16.8849 13.4498 16.8545 13.6211 16.9883C11.6082 17.9589 10 19.6245 10 22H12C12 19.7782 13.7782 18 16 18C18.2218 18 20 19.7782 20 22H22C22 19.6245 20.3918 17.9589 18.3789 16.9883C18.5502 16.8545 18.8554 16.8849 18.9961 16.7266C19.6794 15.9579 20 14.9722 20 14C20 13.0278 19.6794 12.0421 18.9961 11.2734C18.3128 10.5048 17.25 10 16 10ZM16 12C16.75 12 17.1872 12.2452 17.5039 12.6016C17.8206 12.9579 18 13.4722 18 14C18 14.5278 17.8206 15.0421 17.5039 15.3984C17.1872 15.7548 16.75 16 16 16C15.25 16 14.8128 15.7548 14.4961 15.3984C14.1794 15.0421 14 14.5278 14 14C14 13.4722 14.1794 12.9579 14.4961 12.6016C14.8128 12.2452 15.25 12 16 12Z",fill:"#9675F7"})),Ir=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M16.0016 2C12.7047 2 10.0016 4.70313 10.0016 8H6.00157C5.47032 8 5.03282 8.41406 5.00157 8.94531L4.00157 26.9453C3.98595 27.2188 4.08751 27.4922 4.27501 27.6875C4.46251 27.8906 4.72813 28 5.00157 28H27.0016C27.275 28 27.5406 27.8906 27.7281 27.6875C27.9156 27.4922 28.0172 27.2188 28.0016 26.9453L27.0016 8.94531C26.9703 8.41406 26.5328 8 26.0016 8H22.0016C22.0016 4.70313 19.2984 2 16.0016 2ZM16.0016 4C18.2047 4 20.0016 5.79688 20.0016 8H12.0016C12.0016 5.79688 13.7984 4 16.0016 4ZM6.94688 10H10.0016V14H12.0016V10H20.0016V14H22.0016V10H25.0563L25.9391 26H6.06407L6.94688 10Z",fill:"#9675F7"})),Tr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M17 2C15.625 2 14.4688 2.95313 14.1172 4.21875C13.7734 4.07813 13.3906 4 13 4C11.3516 4 10 5.35156 10 7V17L7.89063 16.1406L7.84375 16.125C6.25781 15.6641 4.57813 16.5781 4.125 18.1562C4.03906 18.4375 4 18.7188 4 19C4 20.2578 4.80469 21.3047 5.89063 22.0078L5.8125 21.9531L10.125 25.3984C11.7656 26.8047 13.6641 28 16 28H20C24.375 28 28 24.4297 28 20.0391V9C28 7.35156 26.6484 6 25 6C24.6484 6 24.3125 6.07813 24 6.1875V6C24 4.35156 22.6484 3 21 3C20.4297 3 19.8984 3.17188 19.4453 3.45313C19.0234 2.89844 18.4062 2.47656 17.6875 2.28125C17.5 2.10938 17.2578 2.00781 17 2ZM17 4C17.5625 4 18 4.4375 18 5V14H20V6C20 5.4375 20.4375 5 21 5C21.5625 5 22 5.4375 22 6V14H24V9C24 8.4375 24.4375 8 25 8C25.5625 8 26 8.4375 26 9V20.0391C26 23.3281 23.2969 26 20 26H16C14.3438 26 12.9219 25.1562 11.4375 23.875L11.4219 23.8672L7.03125 20.3594L6.98438 20.3359C6.20313 19.8281 6 19.4766 6 19C6 18.9141 6.01563 18.8125 6.03906 18.7188C6.19531 18.1797 6.73438 17.8906 7.27344 18.0469L12 20V7C12 6.4375 12.4375 6 13 6C13.5625 6 14 6.4375 14 7V14H16V5C16 4.4375 16.4375 4 17 4ZM17.25 16C16.3516 16 16 16.7266 16 17.625C16 19.4531 19 22 19 22C19 22 22 19.5 22 17.625C22 16.7266 21.6484 16 20.75 16C19.5547 16 19 17.3672 19 18C19 17.3672 18.4219 16 17.25 16Z",fill:"#9675F7"})),{Slot:kr,Fill:Mr}=(0,h.createSlotFill)("OnboardSiteTypeBefore");function Ar(){const{clearVisitedLocations:e}=(0,L.useDispatch)(_r),{siteTypes:t,lastVisitedLocation:r}=(0,L.useSelect)((e=>({siteTypes:e(_r).getSiteTypes(),lastVisitedLocation:e(_r).getLastVisitedLocation()})));return(0,s.createElement)(xr,null,(0,s.createElement)(wr,null),(0,s.createElement)(y.xv,{as:"p",size:y.yH.EXTRA_LARGE,text:(0,l.__)("Welcome to Solid Security! Answer a few questions to quickly enable the most important security features for this website. You can always change settings later.","better-wp-security")}),(0,s.createElement)(kr,null),r&&(0,s.createElement)(y.qX,{onDismiss:e,text:(0,s.createElement)(y.xv,null,(0,s.createInterpolateElement)((0,l.__)("Already started setting up Solid Security? <a>Resume</a> from where you left off.","better-wp-security"),{a:(0,s.createElement)(Z.rU,{to:r})}))}),(0,s.createElement)(Sr,null,(0,s.createElement)(y.X6,{level:2,size:y.yH.LARGE,weight:y.fs.HEAVY,text:(0,l.__)("What type of website is this?","better-wp-security")}),(0,s.createElement)(y.xv,{as:"p",variant:y.rK.DARK,text:(0,l.__)("Select the one that best represents your website. This will focus the rest of the setup wizard on the options most necessary to secure the site.","better-wp-security")})),(0,s.createElement)(y.aV,{gap:3},t.map((e=>(0,s.createElement)(y.HC,{key:e.id},(0,s.createElement)(Dr,{id:e.id,title:e.title,description:e.description,recommended:e.recommended}))))))}const Rr={ecommerce:Ir,network:Nr,"non-profit":Tr,blog:Lr,brochure:Cr,portfolio:Or};function Dr({id:e,title:t,description:r,recommended:n}){const{clearSiteType:i}=(0,L.useDispatch)(_r),a=(0,m.$B)(),l=K();return(0,s.createElement)(Re,{onClick:()=>{i(),l(`${a.url}/${e}`)},title:t,description:r,icon:Rr[e],recommended:n})}const Zr=(0,u.Z)("div",{target:"ew23jvl2"})({name:"1c6ezy",styles:"display:flex;flex-direction:column;gap:1.5rem;width:100%;max-width:530px;flex-grow:1;justify-content:center;margin-top:-110px"}),Fr=(0,u.Z)("header",{target:"ew23jvl1"})({name:"p5tmle",styles:"display:flex;flex-direction:column;gap:0.5rem"}),Pr=(0,u.Z)("div",{target:"ew23jvl0"})({name:"1bhviol",styles:"display:flex;gap:3.25rem"}),Hr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M9 4C7.35156 4 6 5.35156 6 7V26H6.42188C6.85938 27.1094 7.74219 28 9 28H26V26H9C8.4375 26 8 25.5625 8 25C8 24.4375 8.4375 24 9 24H26V4H9ZM9 6H24V22H9C8.64844 22 8.3125 22.0781 8 22.1875V7C8 6.4375 8.4375 6 9 6ZM10 10V12H22V10H10Z",fill:"#9675F7"})),Vr=(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)("path",{d:"M22 2C17.5938 2 14 5.59375 14 10C14 10.7109 14.1875 11.3516 14.3594 11.9844L13.875 12.4688L10 8.58594V5.44531L9.53125 5.15625L4.85938 2.23438L2.23438 4.8125L5.4375 10H8.58594L12.4687 13.875L5.17188 21.1719C3.61719 22.7266 3.61719 25.2734 5.17188 26.8281C6.72656 28.3828 9.27344 28.3828 10.8281 26.8281L16 21.6562L21.1719 26.8281C22.7266 28.3828 25.2734 28.3828 26.8281 26.8281C28.3828 25.2734 28.3828 22.7266 26.8281 21.1719L23.5 17.8438C27.1953 17.1406 30 13.8906 30 10C30 8.66406 29.6406 7.42188 29.0781 6.33594L28.4453 5.125L27.4844 6.09375L23.1875 10.3828L21.6172 8.8125L26.875 3.54688L25.6641 2.92188C24.5781 2.35938 23.3359 2 22 2ZM22 4C22.4531 4 22.8438 4.21875 23.2734 4.32813L18.7891 8.8125L23.1875 13.2109L27.6797 8.72656C27.7812 9.15625 28 9.54688 28 10C28 13.3281 25.3281 16 22 16C21.3125 16 20.6562 15.8594 20 15.625L19.4062 15.4219L9.41406 25.4141C8.625 26.2031 7.375 26.2031 6.58594 25.4141C5.79688 24.625 5.79688 23.375 6.58594 22.5859L16.5781 12.5938L16.375 12C16.1406 11.3438 16 10.6875 16 10C16 6.67188 18.6719 4 22 4ZM5.14062 4.76563L8 6.55469V7.83594L7.83594 8H6.5625L4.77344 5.11719L5.14062 4.76563ZM20.0156 17.6406C20.2187 17.6953 20.4219 17.7422 20.625 17.7969L25.4141 22.5859C26.2031 23.375 26.2031 24.625 25.4141 25.4141C24.625 26.2031 23.375 26.2031 22.5859 25.4141L17.4141 20.2422L20.0156 17.6406Z",fill:"#9675F7"})),jr={disableInlineErrors:!0};function Br({prompt:e,description:t,showErrors:r=!0,goBack:n,children:i}){const{error:a}=(0,L.useSelect)((e=>({error:e(_r).getLastError()})),[]);return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(Zr,null,(0,s.createElement)(Fr,null,(0,s.createElement)(y.X6,{level:3,text:e,size:y.yH.EXTRA_LARGE,variant:y.rK.DARK}),(0,s.createElement)(y.xv,{as:"p",text:t,variant:y.rK.MUTED})),r&&(0,s.createElement)(B.KM,{apiError:a}),i),n&&(0,s.createElement)(Je,null,(0,s.createElement)(y.zx,{onClick:n,text:(0,l.__)("Back","better-wp-security"),icon:We.Z,iconPosition:"left",variant:"tertiary"})))}function zr({question:e,onAnswer:t,isAnswering:r,goBack:n}){const{editAnswer:i}=(0,L.useDispatch)(_r),{answer:a,error:o}=(0,L.useSelect)((e=>({error:e(_r).getLastError(),answer:e(_r).getEditedAnswer()}))),[c,d]=(0,s.useState)([]);return(0,s.createElement)(Br,{prompt:e.prompt,description:e.description,showErrors:!1,goBack:n},(0,s.createElement)(B.T,{schema:e.answer_schema,uiSchema:e.answer_schema.uiSchema,formData:a,onChange:({formData:e})=>i(e),onSubmit:({formData:e},r)=>{r.preventDefault(),d([]),t(e)},saveLabel:(0,l.__)("Next","better-wp-security"),formContext:jr,apiError:o,schemaError:c,onError:d,showErrorList:!1,saveDisabled:r,undoDisabled:r,alignActions:"start"}))}function $r({question:e,onAnswer:t,isAnswering:r}){return(0,s.createElement)(Br,{prompt:e.prompt,description:e.description},(0,s.createElement)(Pr,null,(0,s.createElement)(Re,{disabled:r,onClick:()=>t(!1),title:(0,l.__)("My Own Website","better-wp-security"),direction:"vertical",icon:Hr}),(0,s.createElement)(Re,{disabled:r,onClick:()=>t(!0),title:(0,l.__)("Client Website","better-wp-security"),direction:"vertical",icon:Vr})))}function qr(){const{registerQuestionComponent:e}=(0,L.useDispatch)(_r);(0,V.eH)(qr,(()=>{e("is-client",$r)}))}function Ur(){qr();const{goNext:e}=D(),{siteType:t}=(0,m.UO)(),{selectedSiteTypeId:r}=(0,L.useSelect)((e=>({selectedSiteTypeId:e(_r).getSelectedSiteTypeId()})),[]),{selectSiteType:n,applyAnswerResponse:i}=(0,L.useDispatch)(_r),a=function(){const{question:e,component:t,isAnswering:r}=(0,L.useSelect)((e=>{const t=e(_r).getNextQuestion();return{question:t,component:e(_r).getQuestionComponent(t?.id),isAnswering:e(_r).isAnswering()}}),[]),{answerQuestion:n,repeatQuestion:i}=(0,L.useDispatch)(_r);if(!e)return e;const a=(0,s.memo)(t||zr);return(0,s.createElement)(a,{question:e,onAnswer:n,goBack:i,isAnswering:r})}();return(0,s.useLayoutEffect)((()=>{r!==t&&n(t)}),[n,r,t]),(0,s.useEffect)((()=>{null===a&&(i(),e())}),[i,e,a]),a}function Wr(){const{path:e}=(0,m.$B)();return(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:`${e}/:siteType`},(0,s.createElement)(Ur,null)),(0,s.createElement)(m.AW,{path:`${e}`},(0,s.createElement)(Ar,null)))}const Gr=(0,u.Z)(y.mr,{target:"e8ef6wn6"})({name:"8dk3vg",styles:"margin-bottom:1rem"}),Kr=(0,u.Z)(y.Tg,{target:"e8ef6wn5"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";"),Yr=(0,u.Z)("form",{target:"e8ef6wn4"})({name:"1smerdt",styles:"padding:1rem 0"}),Qr=(0,u.Z)("div",{target:"e8ef6wn3"})({name:"e59tbw",styles:"display:flex;align-items:center;justify-content:end;gap:1.5rem;margin-top:2rem"}),Xr=(0,u.Z)("form",{target:"e8ef6wn2"})({name:"jg4g8",styles:"padding:1.25rem 1.5rem;display:flex;flex-direction:column;gap:1.25rem"}),Jr=(0,u.Z)(B._g,{target:"e8ef6wn1"})({name:"17zhf76",styles:"padding:0 1.5rem"}),en=(0,u.Z)("div",{target:"e8ef6wn0"})({name:"7tt4sl",styles:"flex-grow:1;max-width:830px;width:100%"});function tn(){const{root:e}=(0,m.UO)(),{editedModules:t}=(0,L.useSelect)((e=>({editedModules:e(N.MODULES_STORE_NAME).getEditedModules()})),[]),r=t.filter((t=>{if("onboard"===e&&!t.onboard)return!1;if("import"===e&&!t.settings?.import?.length>0)return!1;const r=t.settings?.show_ui;return r||"always-active"!==t.status.default})),n=(0,b.sortBy)(r,"order");return{types:[{slug:"login",label:(0,l.__)("Login Security","better-wp-security")},{slug:"lockout",label:(0,l.__)("Firewall","better-wp-security")},{slug:"site-check",label:(0,l.__)("Site Check","better-wp-security")},{slug:"utility",label:(0,l.__)("Utilities","better-wp-security")},{slug:"advanced",label:(0,l.__)("Advanced","better-wp-security")}].filter((e=>r.find((t=>t.type===e.slug)))),modules:n}}const{Slot:rn,Fill:nn}=(0,h.createSlotFill)("ConfigurePageHeader");function an({module:e}){const{hash:t}=(0,m.TH)(),r=(0,C.useInstanceId)(an,"itsec-configure-single-modules-page"),{config:n}=(0,L.useSelect)((t=>({config:t(N.MODULES_STORE_NAME).getEditedModule(e)})),[e]),{saveSettings:i}=(0,L.useDispatch)(N.MODULES_STORE_NAME),{filterFields:a}=Q(n),{schema:l,uiSchema:o,formData:c,setFormData:d}=Y(n,a);if(!n)return null;const u=t.startsWith(`#${e.id},`)?t.split(",")[1]:t.replace("#","");return(0,s.createElement)(dn,{title:n.title,description:n.description,headerHasBorder:!0},(0,s.createElement)(Kr,null,(0,s.createElement)(rn,null),(0,s.createElement)(Yr,{onSubmit:e=>{e.preventDefault(),i(n.id,!0)},id:r},(0,s.createElement)(pt,{module:n,schema:l,uiSchema:o,formData:c,setFormData:d,highlightedSetting:u}))),(0,s.createElement)(cn,{form:r,modules:[e]}))}function sn({type:e,title:t,description:r}){const{root:n}=(0,m.UO)(),{hash:i}=(0,m.TH)(),a=(0,C.useInstanceId)(sn,"itsec-configure-modules-of-type-page"),{modules:l}=tn(),o=(0,s.useMemo)((()=>l.filter((t=>t.type===e))),[l,e]),c=(0,s.useMemo)((()=>o.map((e=>e.id))),[o]),{saveSettings:d}=(0,L.useDispatch)(N.MODULES_STORE_NAME);return o?(0,s.createElement)(dn,{title:t,description:r,headerHasBorder:!0},(0,s.createElement)(Kr,null,(0,s.createElement)(rn,null),(0,s.createElement)(Xr,{id:a,onSubmit:e=>{e.preventDefault(),d(c,!0)}},o.map((e=>{const t=i===`#${e.id}`||i.startsWith(`#${e.id},`),r=i.startsWith(`#${e.id},`)?i.split(",")[1]:i.replace("#","");return(0,s.createElement)(wt,{key:e.id,module:e,isHighlighted:t,highlightedSetting:r,persistStatus:"settings"===n})})))),(0,s.createElement)(cn,{form:a,modules:c})):null}function ln({exclude:e}){const{types:t,modules:r}=tn(),n=(0,s.useMemo)((()=>t.filter((t=>!e.includes(t.slug)))),[t,e]),{path:i,url:a}=(0,m.$B)();return(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:`${i}/:type`},(0,s.createElement)(on,{allModules:r},(0,s.createElement)(rn,null),(0,s.createElement)(Jr,{size:y.yH.NORMAL},n.map((e=>(0,s.createElement)(B.uC,{key:e.slug,title:e.label,to:`${a}/${e.slug}`})))))),(0,s.createElement)(m.AW,{path:i,exact:!0},n.length>0&&(0,s.createElement)(m.l_,{to:`${a}/${n[0].slug}`})))}function on({allModules:e,children:t}){const{root:r}=(0,m.UO)(),{hash:n}=(0,m.TH)(),i=(0,C.useInstanceId)(ln,"itsec-configure-tabbed-modules-route"),{params:a}=(0,m.$B)(),o=(0,s.useMemo)((()=>e.filter((e=>e.type===a.type))),[e,a]),c=(0,s.useMemo)((()=>o.map((e=>e.id))),[o]),{saveSettings:d}=(0,L.useDispatch)(N.MODULES_STORE_NAME);return(0,s.createElement)(dn,{title:(0,l.__)("Features","better-wp-security"),description:(0,l.__)("Choose and configure security features for your site.","better-wp-security")},(0,s.createElement)(Kr,null,t,(0,s.createElement)(Xr,{id:i,onSubmit:e=>{e.preventDefault(),d(c,!0)}},o.map((e=>{const t=n===`#${e.id}`||n.startsWith(`#${e.id},`),i=n.startsWith(`#${e.id},`)?n.split(",")[1]:n.replace("#","");return(0,s.createElement)(wt,{key:e.id,module:e,isHighlighted:t,highlightedSetting:i,persistStatus:"settings"===r})})))),(0,s.createElement)(cn,{form:i,modules:c}))}function cn({modules:e,form:t}){const{isSaving:r,isDirty:n}=(0,L.useSelect)((t=>({isDirty:t(N.MODULES_STORE_NAME).getDirtySettings().some((t=>e.includes(t))),isSaving:t(N.MODULES_STORE_NAME).isSavingSettings(e)})),[e]),{resetSettingEdits:i}=(0,L.useDispatch)(N.MODULES_STORE_NAME),{root:a}=(0,m.UO)(),{goNext:o}=D();return(0,s.createElement)(Qr,null,(0,s.createElement)(y.zx,{text:(0,l.__)("Undo Changes","better-wp-security"),variant:"secondary",onClick:()=>i(e),disabled:r||!n}),"settings"===a&&(0,s.createElement)(y.zx,{type:"submit",form:t,text:(0,l.__)("Save","better-wp-security"),variant:"primary",isBusy:r,disabled:r||!n}),"settings"!==a&&(0,s.createElement)(y.zx,{text:(0,l.__)("Next","better-wp-security"),variant:"primary",onClick:o}))}function dn({title:e,description:t,headerHasBorder:r,children:n}){const{root:i}=(0,m.UO)();return"settings"===i?(0,s.createElement)(React.Fragment,null,(0,s.createElement)(nn,null,(0,s.createElement)(Gr,{title:e,description:t,hasBorder:r})),n):(0,s.createElement)(en,null,(0,s.createElement)(Ue,{title:e,description:t,showIndicator:!0,showNext:!0}),n)}const un=(0,u.Z)(h.Spinner,{target:"e1lluxma0"})({name:"1goa6k7",styles:"width:80px!important;height:80px!important"});function mn(){const{root:e}=(0,m.UO)(),{goNext:t}=D(),{completeOnboarding:r}=(0,L.useDispatch)(_r);return pn(),(0,V.eH)(mn,(()=>{r({root:e}).then(t)})),(0,s.createElement)(h.Flex,{expanded:!1,direction:"column",gap:4,align:"center"},(0,s.createElement)(un,null),(0,s.createElement)(y.xv,{size:y.yH.LARGE,variant:y.rK.DARK,weight:y.fs.HEAVY,align:"center",text:(0,l.__)("Hang on while your website is secured!","better-wp-security")}))}function pn(){const{registerCompletionStep:e}=(0,L.useDispatch)(_r),{saveModules:t,saveSettings:r}=(0,L.useDispatch)(N.MODULES_STORE_NAME);(0,V.eH)(pn,(()=>{e({id:"savingModules",label:(0,l.__)("Enable Features","better-wp-security"),priority:5,callback:()=>t()}),e({id:"savingSettings",label:(0,l.__)("Configure Settings","better-wp-security"),priority:10,callback:()=>r()})}))}const gn=(0,u.Z)("div",{target:"e62zy9t6"})("max-width:900px;width:100%;flex-grow:1;margin-top:",(({isSmall:e})=>e&&"100px"),";"),fn=(0,u.Z)("ul",{target:"e62zy9t5"})({name:"a5ny1u",styles:"list-style:disc inside;display:flex;flex-direction:column;gap:0.75rem;margin:0"}),hn=(0,u.Z)("li",{target:"e62zy9t4"})({name:"11utca0",styles:"margin:0 0.5rem"}),En=(0,u.Z)("div",{target:"e62zy9t3"})("margin-top:3.5rem;padding:1.5rem;border:1px solid ",(({theme:e})=>e.colors.border.normal),';border-radius:2px;box-shadow:0 4px 8px 0 #00000033;background:no-repeat url("',q.sC,'");background-position:right -40px top -35px;background-size:180px;@media screen and (min-width: ',(({theme:e})=>e.breaks.small),"px ){background-position:right -50% center;background-size:65%;}"),yn=(0,u.Z)(h.Flex,{target:"e62zy9t2"})({name:"15xgxri",styles:"max-width:700px"}),bn=(0,u.Z)(y.aV,{target:"e62zy9t1"})({name:"1f342kp",styles:"display:grid;grid-template-columns:repeat(auto-fit, minmax(225px, 1fr));gap:1.25rem"}),vn=(0,u.Z)(y.zx,{target:"e62zy9t0"})({name:"135vrw8",styles:"align-self:start"}),_n=[{text:(0,l.__)("User security strengthened","better-wp-security"),activeModules:["two-factor","passwordless-login","fingerprinting"]},{text:(0,l.__)("Brute force attacks blocked","better-wp-security"),activeModules:["brute-force","network-brute-force","recaptcha"]},{text:(0,l.__)("Scanning for vulnerable themes, plugins, and known malware","better-wp-security"),activeModules:["malware-scheduling"]},{text:(0,l.__)("Monitoring for suspicious file changes","better-wp-security"),activeModules:["file-change"]},{text:(0,l.__)("Banning bad bots and user agents","better-wp-security"),activeModules:["ban-users"]}];function xn(){const{allActiveModules:e}=(0,L.useSelect)((e=>({allActiveModules:e(N.MODULES_STORE_NAME).getActiveModules()})),[]),t=_n.filter((({activeModules:t})=>t.find((t=>e.includes(t)))));return t.length?(0,s.createElement)(h.Flex,{direction:"column",gap:3,justify:"start",expanded:!1},(0,s.createElement)(y.X6,{level:3,size:y.yH.LARGE,variant:y.rK.DARK,weight:y.fs.HEAVY,text:(0,l.__)("Here are some notable improvements…","better-wp-security")}),(0,s.createElement)(fn,null,t.map((({text:e},t)=>(0,s.createElement)(hn,{key:t},(0,s.createElement)(y.xv,{text:e})))))):null}function wn({installType:e}){const t=(0,U.bv)("dashboard"),r=(0,U.bv)("settings");return(0,s.createElement)(h.Flex,{direction:"column",gap:8,expanded:!1,align:"start"},(0,s.createElement)(B.TR,{size:44}),(0,s.createElement)(h.Flex,{as:"header",direction:"column",gap:2,expanded:!1},(0,s.createElement)(y.X6,{level:1,text:"free"===e?(0,l.__)("Great Work! Thanks to Solid Security Basic, your site is secure and ready for your users.","better-wp-security"):(0,l.__)("Great Work! Your site is ready and is more secure than ever!","better-wp-security"),size:y.yH.GIGANTIC,weight:y.fs.NORMAL}),(0,s.createElement)(y.xv,{text:"free"===e?(0,l.__)("Use your security dashboard for insights into your users’ activity and potential threats to your site. From there you’ll be guided to actions you can take.","better-wp-security"):(0,l.__)("If you want to dig into your site’s security, check out your security dashboard, and make changes via settings.","better-wp-security"),size:y.yH.EXTRA_LARGE,variant:y.rK.DARK})),(0,s.createElement)(h.Flex,{gap:4,justify:"start"},(0,s.createElement)(y.zx,{variant:"free"===e?"secondary":"primary",href:t,text:(0,l.__)("Dashboard","better-wp-security")}),(0,s.createElement)(y.zx,{variant:"free"===e?"secondary":"primary",href:r,text:(0,l.__)("Settings","better-wp-security")})),(0,s.createElement)(xn,{installType:e}))}var Sn=r(14776);const Cn=(0,s.createElement)(Sn.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)(Sn.Path,{d:"M9 13.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM9 16a4.002 4.002 0 003.8-2.75H15V16h2.5v-2.75H19v-2.5h-6.2A4.002 4.002 0 005 12a4 4 0 004 4z",fillRule:"evenodd",clipRule:"evenodd"})),Ln=[(0,s.createInterpolateElement)((0,l.__)("A <b>Firewall</b> that automatically blocks brute force logins, password-stuffing, DDoS attacks, bad bots, and any attempts to exploit vulnerable software on your site.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Virtual Patches</b> from <b>Patchstack</b> that protect insecure themes and plugins even before vulnerabilities are publicly disclosed and an official patch is released. You may not be able to apply security updates immediately, but with Solid Security Pro you’re still protected until you’re ready to update.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Version Management</b> gives you precise control over when to apply or delay an automatic update to any plugin, theme, extension, or WordPress core.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("<b>Passkeys</b> and other <b>Passwordless</b> Login options mitigate the risks associated with users who often share, reuse, and choose weak passwords. Increase your users’ security and simplify their login experience.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})}),(0,s.createInterpolateElement)((0,l.__)("Multiple <b>CAPTCHA</b> options, including <b>Cloudflare Turnstile</b>, eliminate bot traffic from your login screens and other forms. You won’t be asked to solve a puzzle or identify objects to prove you’re a human — unless you’re a bot.","better-wp-security"),{b:(0,s.createElement)(y.xv,{weight:700})})],Nn=[(0,l.__)("Passwordless Login and Passkeys","better-wp-security"),(0,l.__)("Two-Factor","better-wp-security"),(0,l.__)("Captcha","better-wp-security"),(0,l.__)("Version Management","better-wp-security"),(0,l.__)("Trusted Devices","better-wp-security"),(0,l.__)("Import & Export","better-wp-security"),(0,l.__)("WP-CLI","better-wp-security")];function On({installType:e}){return(0,s.createElement)(En,null,(0,s.createElement)(yn,{direction:"column",justify:"start",expanded:!1,gap:4},(0,s.createElement)(y.X6,{level:2,weight:y.fs.NORMAL,size:y.yH.EXTRA_LARGE,variant:y.rK.ACCENT,text:"free"===e?(0,l.__)("Reduce your site’s security risk to nearly zero with Solid Security Pro.","better-wp-security"):(0,l.__)("Greatly enhance your website’s security with Solid Security Pro.","better-wp-security")}),(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:"free"===e?(0,l.__)("Extended features for professionals include:","better-wp-security"):(0,l.__)("You are a WordPress security superstar! Be sure to take advantage of the features that comes with your paid plan. Paid features include…","better-wp-security")}),(0,s.createElement)(bn,{textVariant:y.rK.DARK,gap:0},"free"===e?(0,s.createElement)(React.Fragment,null,Ln.map(((e,t)=>(0,s.createElement)(y.HC,{icon:Cn,text:e,key:t})))):(0,s.createElement)(React.Fragment,null,Nn.map(((e,t)=>(0,s.createElement)(y.HC,{icon:Cn,text:e,key:t}))))),"free"===e?(0,s.createElement)(vn,{href:"https://go.solidwp.com/go-pro-onboarding",variant:"primary",text:(0,l.__)("Upgrade to Solid Security Pro","better-wp-security")}):(0,s.createElement)(y.xv,{variant:y.rK.MUTED,text:(0,l.__)("and more!","better-wp-security")})))}function In(){const{installType:e}=(0,L.useSelect)((e=>({installType:e(N.coreStore).getInstallType()})),[]),t=(0,C.useViewportMatch)("small");return(0,s.createElement)(gn,{isSmall:t},(0,s.createElement)(wn,{installType:e}),(0,s.createElement)(On,{installType:e}))}function Tn(){const e=M(),{url:t,path:r}=(0,m.$B)(),{pathname:n}=(0,m.TH)(),{recordVisitedLocation:i}=(0,L.useDispatch)(_r);return(0,s.useEffect)((()=>{i(n)}),[i,n]),(0,s.createElement)(m.rs,null,e.map((({id:e,render:n})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(tt,{url:t,render:n})))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(rt,null)))}var kn=r(50460);function Mn(){const e=M(),{url:t,path:r}=(0,m.$B)();return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(B.ge,{area:"main"},(0,s.createElement)(kn.o,null)),(0,s.createElement)(m.rs,null,e.map((({id:e,render:t})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(ve,null,(0,s.createElement)(je,null),(0,s.createElement)(t,null))))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(ve,null))))}function An(){const e=M(),{url:t,path:r}=(0,m.$B)();return e.length>0&&!e.find((e=>"select-export"===e.id))?(0,s.createElement)(m.l_,{to:"/"}):(0,s.createElement)(m.rs,null,e.map((({id:e,render:n})=>(0,s.createElement)(m.AW,{path:`${r}/:page(${e})`,key:e},(0,s.createElement)(tt,{url:t,render:n})))),(0,s.createElement)(m.AW,{path:t},e.length>0&&(0,s.createElement)(m.l_,{to:`${t}/${e[0].id}`}),(0,s.createElement)(rt,null)))}function Rn(){return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(T,{id:"site-type",title:(0,l.__)("Website","better-wp-security"),priority:0,roots:["onboard"]},(()=>(0,s.createElement)(Wr,null))),(0,s.createElement)(T,{id:"global",title:(0,l.__)("Global Settings","better-wp-security"),priority:4,roots:["onboard","settings","import"]},(()=>(0,s.createElement)(an,{module:"global"}))),(0,s.createElement)(T,{id:"configure",title:(0,l.__)("Features","better-wp-security"),priority:6,roots:["onboard","settings","import"]},(()=>(0,s.createElement)(ln,{exclude:["advanced"]}))),(0,s.createElement)(T,{id:"advanced",title:(0,l.__)("Advanced","better-wp-security"),priority:25,roots:["settings"]},(()=>(0,s.createElement)(sn,{type:"advanced",title:(0,l.__)("Advanced","better-wp-security"),description:(0,l.__)("Configure advanced Solid Security settings.","better-wp-security")}))),(0,s.createElement)(T,{id:"secure-site",title:(0,l.__)("Secure Site","better-wp-security"),priority:95,roots:["onboard","import"],hideFromNav:!0},(()=>(0,s.createElement)(mn,null))),(0,s.createElement)(T,{id:"summary",title:(0,l.__)("Summary","better-wp-security"),priority:100,roots:["onboard","import"],hideFromNav:!0},(()=>(0,s.createElement)(In,null))))}function Dn(){const{registerProvider:e}=(0,L.useDispatch)(kn.G);(0,V.eH)(Dn,(()=>{e("modules",(0,l.__)("Features","better-wp-security"),5,(({registry:e,evaluate:t,results:r})=>e.select(N.MODULES_STORE_NAME).getEditedModules().reduce(((e,n)=>{const i=Zn(n);return i&&(t.stringMatch(n.title)||t.stringMatch(n.description)||t.keywordMatch(n.keywords))?(r.items.push({title:n.title,description:n.description,route:i}),e+1):e}),0))),e("settings",(0,l.__)("Settings","better-wp-security"),20,(({registry:e,evaluate:t,results:r})=>e.select(N.MODULES_STORE_NAME).getEditedModules().reduce(((e,n)=>{if("active"!==n.status.selected||!n.settings?.interactive?.length)return e;const i=Zn(n);return i?e+n.settings.interactive.reduce(((e,a)=>{var s,l,o;const c=n.settings.schema.properties[a],d=n.settings.schema.uiSchema?.[a];if(!c)return e;const u=d?.ui?.title||d?.["ui:title"]||c.title,m=d?.ui?.description||d?.["ui:description"]||c.description;if(!t.stringMatch(u)&&!t.stringMatch(m)&&!t.keywordMatch(c.keywords))return e;null!==(o=(s=r.groups)[l=n.id])&&void 0!==o||(s[l]={title:n.title,items:[]});const p=i.includes("#")?`${i},${a}`:`${i}#${a}`;return r.groups[n.id].items.push({title:u,description:m,route:p}),e++}),0):e}),0)))}))}function Zn(e){if("global"===e.id)return"/settings/global";if("custom"!==e.type&&"tool"!==e.type&&"recommended"!==e.type){if("advanced"===e.type)return`/settings/advanced#${e.id}`;if("always-active"!==e.status.default||e.settings?.show_ui)return`/settings/configure/${e.type}#${e.id}`}}const Fn=(0,u.Z)(y.Tg,{target:"e1qzbj170"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"});function Pn({history:e,serverType:t,installType:r,onboardComplete:n}){Dn();const i=n?"/settings":"/onboard";return(0,s.createElement)(f.a,{theme:y.U1},(0,s.createElement)(Fn,{className:"itsec-settings",variant:y.h1.UNDER_PAGE},(0,s.createElement)(W.Provider,{value:{serverType:t,installType:r,onboardComplete:n}},(0,s.createElement)(m.F0,{history:e},(0,s.createElement)(p.Fz,{ReactRouterRoute:m.AW},(0,s.createElement)(h.SlotFillProvider,null,(0,s.createElement)(g.ErrorBoundary,{FallbackComponent:Hn},(0,s.createElement)(I,null,(0,s.createElement)(Rn,null),(0,s.createElement)(E.PluginArea,null),(0,s.createElement)(h.Popover.Slot,null),(0,s.createElement)(m.rs,null,(0,s.createElement)(m.AW,{path:"/:root(settings)",component:Mn}),(0,s.createElement)(m.AW,{path:"/:root(onboard)",component:Tn}),(0,s.createElement)(m.AW,{path:"/:root(import)",component:An}),(0,s.createElement)(m.AW,{path:"/"},(0,s.createElement)(m.l_,{to:i}),(0,s.createElement)(j,null),(0,s.createElement)(ve,null)))))))))))}function Hn(e){return(0,s.createElement)(h.Flex,null,(0,s.createElement)(h.FlexBlock,null,(0,s.createElement)(Fe,e)))}r.p=window.itsecWebpackPublicPath,(0,l.setLocaleData)({"":{}},"better-wp-security");const Vn=(0,d.f)(document.location,{page:"itsec"});c()((()=>{const e=document.getElementById("itsec-settings-root");if(!e)return;const t=e.dataset.serverType,r=e.dataset.installType,n="1"===e.dataset.onboard;return(0,s.render)((0,s.createElement)(Pn,{history:Vn,serverType:t,installType:r,onboardComplete:n}),e)}))},79612:(e,t,r)=>{"use strict";r.d(t,{f:()=>s});var n=r(90071),i=r(17563),a=r(92819);function s(e,t){const r=(0,n.lX)(),s=r=>{const a="string"==typeof r?(0,n.cP)(r):r,s=(0,i.parse)(a.search?.substring(1))||{};return{...a,pathname:e.pathname,search:"?"+(0,i.stringify)({...s,path:a.pathname,...t})}};return{get length(){return r.length},get action(){return r.action},get location(){const e=(0,i.parse)(r.location.search.substring(1)),n=e.path||"/";return{...r.location,pathname:n,search:"?"+(0,i.stringify)((0,a.omit)(e,["path",Object.keys(t)]))}},createHref:e=>r.createHref(s(e)),push:(e,t)=>{r.push(s(e),t)},replace:(e,t)=>{r.replace(s(e),t)},go:(...e)=>r.go.apply(r,e),goBack:(...e)=>r.goBack.apply(r,e),goForward:(...e)=>r.goForward.apply(r,e),block:(...e)=>r.block.apply(r,e),listen(e){return r.listen((()=>{e(this.location,this.action)}))}}}},33590:(e,t,r)=>{"use strict";r.d(t,{bB:()=>$,ZP:()=>X});var n={};r.r(n),r.d(n,{BaseInput:()=>d,CheckboxWidget:()=>p,CheckboxesWidget:()=>g,IncludeExcludeWidget:()=>k,RadioWidget:()=>N,SelectWidget:()=>v,TextareaWidget:()=>x,ToggleWidget:()=>m});var i={};r.r(i),r.d(i,{EntitySelectField:()=>F,FileTreeField:()=>z,TextareaListField:()=>H,TitleField:()=>R});var a=r(92819),s=r(87462),l=r(6293),o=r(64893),c=r(36179);const d=function(e){const{id:t,label:r,value:n,readonly:i,disabled:d,onBlur:u,onFocus:m,options:p,onChange:g,schema:f,uiSchema:h={},...E}=e;p.inputType?E.type=p.inputType:E.type||("number"===f.type?(E.type="number",E.step="any"):"integer"===f.type?(E.type="number",E.step="1"):E.type="text"),p.autocomplete&&(E.autoComplete=p.autocomplete),f.multipleOf&&(E.step=f.multipleOf),void 0!==f.minimum&&(E.min=f.minimum),void 0!==f.maximum&&(E.max=f.maximum);const y=h["ui:description"]||f.description;return(0,l.createElement)(o.TextControl,(0,s.Z)({label:r,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:y}),readOnly:i,disabled:d,value:n||""},(0,a.omit)(E,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>g(""===e?p.emptyValue:e),onBlur:u&&(e=>u(E.id,e.target.value)),onFocus:m&&(e=>m(E.id,e.target.value))}))};var u=r(54639);function m({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:a,label:s,onBlur:d,onFocus:m,onChange:p}){const g=u.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,l.createElement)(o.ToggleControl,{checked:n||!1,onChange:p,required:g,disabled:i,readOnly:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:d&&(e=>d(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function p({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:a,label:s,onBlur:d,onFocus:m,onChange:p}){const g=u.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,l.createElement)(o.CheckboxControl,{checked:n||!1,onChange:p,required:g,disabled:i,readOnly:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:d&&(e=>d(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function g(e){const{disabled:t,options:r,value:n,readonly:i,onChange:a,label:s,schema:o,uiSchema:d={}}=e,{enumOptions:u,enumDisabled:m=[],enumDescriptions:p=[],style:g}=r,f=d["ui:description"]||o.description,h=u.map(((e,t)=>({...e,disabled:m.includes(e.value),help:p[t]&&(0,l.createElement)(c.Lu,{noWrap:!0,content:p[t]})})));return(0,l.createElement)(c.w2,{value:n||[],onChange:a,options:h,label:s||d["ui:title"]||o.title,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:f}),readOnly:i,disabled:t,style:g})}const{asNumber:f,guessType:h}=u.P6,E=new Set(["number","integer"]);function y(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&E.has(n.type))return t.map(f);if("boolean"===r)return"true"===t;if("number"===r)return f(t);if(e.enum){if(e.enum.every((e=>"number"===h(e))))return f(t);if(e.enum.every((e=>"boolean"===h(e))))return"true"===t}return t}}function b(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const v=function(e){const{schema:t,uiSchema:r={},id:n,options:i,value:a,label:s,required:d,disabled:u,readonly:m,multiple:p,onChange:g,onBlur:f,onFocus:h,placeholder:E}=e,{enumOptions:v,enumDisabled:_}=i,x=p?[]:"",w=[];p||void 0!==t.default||w.push({value:"",label:E});for(const e of v)w.push({...e,disabled:_&&_.includes(e.value)});const S=r["ui:description"]||t.description;return(0,l.createElement)(o.SelectControl,{multiple:p,options:w,value:void 0===a?x:a,label:s,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:S}),required:d,disabled:u,readOnly:m,onChange:e=>g(y(t,e)),onBlur:f&&(e=>f(n,y(t,b(e,p)))),onFocus:h&&(e=>h(n,y(t,b(e,p))))})},{getUiOptions:_}=u.P6;function x({schema:e,uiSchema:t={},id:r,value:n,disabled:i,readonly:d,label:u,onBlur:m,onFocus:p,onChange:g,...f}){const h=_(t),{rows:E,placeholder:y,description:b=e.description}=h;return(0,l.createElement)(o.TextareaControl,(0,s.Z)({value:void 0===n?"":n,onChange:g,disabled:i,readOnly:d,label:u,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:b}),onBlur:m&&(e=>m(r,e.target.value)),onFocus:p&&(e=>p(r,e.target.value)),rows:E,placeholder:y},(0,a.without)(f,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:w,guessType:S}=u.P6,C=new Set(["number","integer"]);function L(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&C.has(n.type))return t.map(w);if("boolean"===r)return"true"===t;if("number"===r)return w(t);if(e.enum){if(e.enum.every((e=>"number"===S(e))))return w(t);if(e.enum.every((e=>"boolean"===S(e))))return"true"===t}return t}}function N({schema:e,uiSchema:t={},id:r,options:n,value:i,label:a,required:s,disabled:d,readonly:u,onChange:m,onBlur:p,onFocus:g}){const{enumOptions:f}=n,h=t["ui:description"]||e.description;return(0,l.createElement)(o.RadioControl,{selected:i,options:f,label:a,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:h}),required:s,disabled:d,readOnly:u,onChange:t=>m(L(e,t)),onBlur:p&&(t=>p(r,L(e,t.target.value))),onFocus:g&&(t=>g(r,L(e,t.target.value)))})}var O=r(95122),I=r(82839),T=r(81019);function k({id:e,disabled:t,options:r,value:n,onChange:i,schema:s,autofocus:c,readonly:d}){const{enumOptions:u,enumDisabled:m=[],excludeList:{title:p=(0,O.__)("Excluded","better-wp-security"),description:g=(0,O.__)("The list of items to exclude from the selection.","better-wp-security"),button:f=(0,O.__)("Include","better-wp-security")}={},includeList:{title:h=(0,O.__)("Included","better-wp-security"),description:E=(0,O.__)("The list of items to include in the selection.","better-wp-security"),button:y=(0,O.__)("Exclude","better-wp-security")}={},title:b=s.title,description:v=s.description}=r;(0,l.useEffect)((()=>{const e=u.map((e=>e.value)),t=n.filter((t=>e.includes(t)));t.length!==n.length&&i(t)}),[n,u,i]);const[_,x]=(0,a.partition)(u,(e=>!n.includes(e.value)));return(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},b&&(0,l.createElement)(o.BaseControl.VisualLabel,null,b),v&&(0,l.createElement)("p",null,v),(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,l.createElement)(M,{id:e+"__exclude",options:_,label:p,description:g,button:f,disabled:t||d,disabledOptions:m,autofocus:c,onToggle:e=>{(0,I.speak)((0,O.sprintf)((0,O.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(_,{value:e}).label,h)),i([...n,e])}}),(0,l.createElement)(M,{id:e+"__include",options:x,label:h,description:E,button:y,disabled:t||d,disabledOptions:m,onToggle:e=>{(0,I.speak)((0,O.sprintf)((0,O.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(x,{value:e}).label,p)),i(n.filter((t=>t!==e)))}})))}function M({id:e,label:t,description:r,options:n,button:i,onToggle:s,disabled:d,disabledOptions:u=[],autofocus:m}){const p=e+"__option__",[g,f]=(0,l.useState)("");return g&&!(0,a.find)(n,{value:g})&&f(""),(0,l.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,l.createElement)(o.BaseControl,{id:e,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:r}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,l.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,l.createElement)(c.T2,{role:"listbox",id:e,active:g&&p+g,"aria-labelledby":e+"__label","aria-describedby":r&&e+"__help",onNavigate:e=>f(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!g||e!==T.DELETE&&e!==T.BACKSPACE)return;const t=(0,a.findIndex)(n,{value:g}),r=t+1<n.length?t+1:t-1;s(g),f(n[r]?.value||"")},autoFocus:m},n.map((e=>(0,l.createElement)("div",{id:p+e.value,key:e.value,role:d||u.includes(e.value)?"presentation":"option","aria-selected":e.value===g||void 0,onClick:d||u.includes(e.value)?void 0:()=>f(e.value)},e.label))))),(0,l.createElement)(o.Button,{variant:"secondary",disabled:!g,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>s(g),"aria-keyshortcuts":"Delete Backspace"},i))}const A="*";function R(e){const{id:t,title:r,required:n}=e;return(0,l.createElement)("span",{className:"itsec-rjsf-title-field",id:t},r,n&&(0,l.createElement)("span",{className:"required"},A))}var D=r(1986);const{getUiOptions:Z}=u.P6;function F({uiSchema:e,schema:t,idSchema:r,name:n,formData:i,disabled:a,readonly:s,onChange:o}){const c=Z(e);return(0,l.createElement)(D.fv,{id:r.$id,value:i,disabled:a,readonly:s,onChange:o,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||n,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}const{getUiOptions:P}=u.P6;function H({uiSchema:e,schema:t,name:r,formData:n,disabled:i,readonly:a,onChange:s}){const o=e["ui:title"]||t.title||r,d=e["ui:description"]||t.description,u=P(e),{rows:m,placeholder:p}=u;return(0,l.createElement)(c.yA,{label:o,help:(0,l.createElement)(c.Lu,{noWrap:!0,content:d}),disabled:i,readonly:a,rows:m,value:n,onChange:s,placeholder:p})}var V=r(87514),j=r.n(V),B=r(73470);function z({idSchema:e,formData:t,onChange:r,uiSchema:n,schema:i,name:s,disabled:d,readonly:u,autofocus:m}){const p=e.$id,g=n["ui:title"]||i.title||s,f=n["ui:description"]||i.description,[h,E]=(0,l.useState)([]),[y,b]=(0,l.useState)("");(0,l.useEffect)((()=>{j()({path:(0,B.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(E)}),[]);const v=e=>{r(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,l.createElement)("div",{className:"itsec-rjsf-file-tree"},f&&(0,l.createElement)(c.Lu,{content:f,tagName:"p"}),(0,l.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,l.createElement)("div",null,(0,l.createElement)(c.mp,{tree:h,id:p,label:(0,O.__)("File Selector","better-wp-security"),active:y,setActive:b,onActivate:v,onLoad:async e=>{const t=await j()({path:(0,B.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),r=(0,a.cloneDeep)(h);(0,c.in)(r,(r=>{if(r.id===e)return r.children=t,c.in.halt})),E(r)}}),(0,l.createElement)(o.Button,{variant:"secondary",disabled:!y,className:"itsec-rjsf-file-tree__select",onClick:()=>v(y),"aria-keyshortcuts":"Enter Space"},(0,O.__)("Select","better-wp-security"))),(0,l.createElement)(c.yA,{value:t,onChange:r,className:"itsec-rjsf-file-tree__list",label:g,disabled:d,readonly:u,autoFocus:m})))}function $({name:e,...t}){return(0,l.createElement)(o.Fill,(0,s.Z)({name:`RjsfField${e}`},t))}function q({name:e,...t}){return(0,l.createElement)(o.Slot,(0,s.Z)({name:`RjsfField${e}`},t))}const{ADDITIONAL_PROPERTY_FLAG:U,getUiOptions:W}=u.P6;function G(e){const{id:t,classNames:r,disabled:n,label:i,onKeyChange:a,onDropPropertyClick:s,readonly:c,required:d,schema:u,uiSchema:m}=e,p=`${i} Key`,g=u.hasOwnProperty(U),{removable:f}=W(m);return g&&!1!==f?(0,l.createElement)("div",{className:r},(0,l.createElement)("div",{className:"row"},(0,l.createElement)("div",{className:"col-xs-5 form-additional"},(0,l.createElement)(o.TextControl,{label:p,required:d,id:`${t}-key`,onBlur:e=>a(e.target.value)})),(0,l.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,l.createElement)("div",{className:"col-xs-2"},(0,l.createElement)(o.Button,{icon:"no-alt",isDestructive:!0,disabled:n||c,onClick:s(i)})))):(0,l.createElement)("div",{className:r},e.children)}const{canExpand:K}=u.P6;function Y({className:e,onClick:t,disabled:r}){return(0,l.createElement)("div",{className:"row"},(0,l.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,l.createElement)(o.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,O.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:r})))}const Q={FieldTemplate:function(e){const{children:t,errors:r,hidden:n,schema:i,uiSchema:a,formContext:s,onChange:c}=e;if(n)return null;const{resettable:d}=W(a);return(0,l.createElement)(G,e,t,(0,l.createElement)(q,{name:e.id,fillProps:e}),d&&(0,l.createElement)(o.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>c(i.default)},(0,O.__)("Restore Default","better-wp-security")),!0!==s?.disableInlineErrors&&r)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:r,schema:n,uiSchema:i,properties:a}=e;if(!a.length)return null;const s=(i["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!n.properties[e]))]:t})),{});return(0,l.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(i["ui:title"]||e.title)&&(0,l.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||i["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,l.createElement)(r,{id:`${e.idSchema.$id}__description`,description:(0,l.createElement)(c.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),a.map((({name:e,content:t})=>s[e]?(0,l.createElement)(l.Fragment,{key:e},(0,l.createElement)("h3",{className:"itsec-rjsf-section-title"},s[e].title),s[e].description&&(0,l.createElement)("p",{className:"itsec-rjsf-section-description"},(0,l.createElement)(c.Lu,{noWrap:!0,content:s[e].description})),t):t)),K(n,i,e.formData)&&(0,l.createElement)(Y,{className:"object-property-expand",onClick:e.onAddClick(n),disabled:e.disabled||e.readonly}))},ErrorList:function({errors:e}){return(0,l.createElement)(c.KM,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})},widgets:n,fields:i},X=Q},50460:(e,t,r)=>{"use strict";r.d(t,{G:()=>P,o:()=>I});var n={};r.r(n),r.d(n,{REGISTER_PROVIDER:()=>D,registerProvider:()=>R});var i={};r.r(i),r.d(i,{getProviders:()=>Z});var a=r(87462),s=r(6293),l=r(73727),o=r(16550),c=r(90071),d=r(92819),u=r(64893),m=r(95122),p=r(48015),g=r(9576),f=r(81019),h=r(82839),E=r(71930),y=r(65813),b=r(36179),v=r(86033),_=r(13092);function x(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var w=new WeakMap,S=new WeakMap,C=new WeakMap,L=new WeakMap,N=new WeakMap;class O{constructor(e,t){x(this,w,{writable:!0,value:void 0}),x(this,S,{writable:!0,value:void 0}),x(this,C,{writable:!0,value:void 0}),x(this,L,{writable:!0,value:void 0}),x(this,N,{writable:!0,value:void 0}),(0,_.Z)(this,w,e),(0,_.Z)(this,S,t),(0,_.Z)(this,C,t.select(P).getProviders()),this._prepare()}_prepare(){(0,_.Z)(this,N,(0,v.Z)(this,w).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,v.Z)(this,w).endsWith(" ");(0,_.Z)(this,L,new RegExp((0,v.Z)(this,N).map(((t,r)=>r+1!==(0,v.Z)(this,N).length||e?`(?=.*\\b${(0,d.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,d.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,v.Z)(this,L).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,v.Z)(this,N).some(((t,r)=>e.includes(" ")?this._stringMatch(e):r===(0,v.Z)(this,N).length-1?e.startsWith(t):t===e))))}getResults(){if((0,v.Z)(this,w).length<3)return[{},0];let e=0;const t=[],r={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const n of(0,v.Z)(this,C)){const i={title:n.title,items:[],groups:{}};e+=n.callback({evaluate:r,results:i,registry:(0,v.Z)(this,S)}),!i.items.length&&(0,d.isEmpty)(i.groups)||t.push(i)}return[t,e]}}const I=(0,s.forwardRef)((function({onPick:e=d.noop,showResults:t},r){const[n,i]=(0,s.useState)(""),[l,o]=(0,s.useState)(!1),c=(0,s.useRef)(),u=(0,s.useRef)(),[b,v]=(0,s.useState)([]),_=(0,p.useRegistry)(),x=(0,s.useCallback)((e=>{const t=new O(e,_).getResults();v(t[0]),(0,h.speak)((0,m.sprintf)((0,m._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[_]),w=(0,g.useDebounce)(x,50),S=(0,s.useCallback)((e=>{c.current&&(e.preventDefault(),c.current.focus())}),[c]);return(0,g.useKeyboardShortcut)("/",S),(0,s.createElement)("div",(0,a.Z)({className:"itsec-search"},(0,y.Zk)((()=>o(!1)))),(0,s.createElement)("div",null,(0,s.createElement)(E.lD,{value:n,onChange:e=>{i(e),w(e)},onFocus:()=>o(!0),onKeyDown:e=>{e.keyCode===f.DOWN&&(e.preventDefault(),u.current.focus())},ref:(0,y.qq)([r,c]),placeholder:(0,m.__)("Search for features, settings, and more","better-wp-security"),omitSeparators:!0,size:"large"}),(l||t)&&n.length>=3&&(0,s.createElement)(T,{results:b,exitSearch:t=>{e(t),o(!1)},ref:u,onPick:e})))})),T=(0,s.forwardRef)((function({results:e,exitSearch:t,onPick:r},n){const i=(0,s.useRef)();(0,s.useImperativeHandle)(n,(()=>({focus(){i.current.focus()}})));const l=(0,g.useInstanceId)(T,"itsec-search"),p=l+"__result__",h=function(){const e=(0,o.k6)();return(t,r="push")=>e[r]((0,c.ob)(t))}(),[E,y]=(0,s.useState)("");return(0,d.isEmpty)(e)?null:(0,s.createElement)(React.Fragment,null,(0,s.createElement)(u.VisuallyHidden,{id:l+"__label"},(0,m.__)("Search Results","better-wp-security")),(0,s.createElement)(b.T2,{className:"itsec-search__results",id:l,active:E&&p+E,onNavigate:e=>y(e.substring(p.length)),onKeyDown:({keyCode:e})=>{!E||e!==f.ENTER&&e!==f.SPACE||(r(E),h(E),t())},onFocus:()=>{if(!E&&!(0,d.isEmpty)(e)){const[,t]=Object.entries(e)[0];if(t.items?.length)y(t.items[0].route);else if(!(0,d.isEmpty)(t.groups)){const[,e]=Object.entries(t.groups)[0];y(e.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:i,"aria-labelledby":l+"__label"},(0,d.map)(e,((e,r)=>(0,s.createElement)(k,(0,a.Z)({key:r},e,{active:E,idPrefix:p,exitSearch:t}))))))}));function k({title:e,items:t,groups:r,...n}){const i=(0,g.useInstanceId)(T,"itsec-search__kind");return(0,s.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":i},(0,s.createElement)("li",{role:"presentation",id:i},e),(t||[]).map((e=>(0,s.createElement)(A,(0,a.Z)({key:e.route},e,n)))),(0,d.map)(r,((e,t)=>(0,s.createElement)(M,(0,a.Z)({key:t},e,n)))))}function M({title:e,items:t,...r}){const n=(0,g.useInstanceId)(T,"itsec-search__group");return(0,s.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":n},(0,s.createElement)("li",{role:"presentation",id:n},(0,s.createElement)("span",null,e)),(t||[]).map((e=>(0,s.createElement)(A,(0,a.Z)({key:e.route},e,r)))))}function A({title:e,description:t,route:r,active:n,idPrefix:i,exitSearch:a}){return(0,s.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":n===r||void 0,id:i+r,"aria-label":e},(0,s.createElement)(l.rU,{to:r,tabIndex:-1,onClick:()=>a(r)},(0,s.createElement)("span",null,e),(0,s.createElement)(b.Lu,{content:t,noHtml:!0,tagName:"p"})))}function R(e,t,r,n){return{type:D,slug:e,title:t,priority:r,callback:n}}const D="REGISTER_PROVIDER",Z=(0,r(28306).Z)((e=>(0,d.sortBy)(e.providers,"priority")),(e=>e.providers)),F={providers:{}},P="ithemes-security/search";(0,p.registerStore)(P,{actions:n,selectors:i,reducer:function(e=F,t){return t.type===D?{...e,providers:{...e.providers,[t.slug]:(0,d.omit)(t,["type"])}}:e}})},1986:(e,t,r)=>{"use strict";r.d(t,{U9:()=>Ie,qb:()=>$,a7:()=>q,kS:()=>we,fv:()=>m,KM:()=>f,nU:()=>oe,TR:()=>pe,Lu:()=>x,uC:()=>se,T:()=>I,b:()=>T,Ph:()=>z,_g:()=>ae,ge:()=>J,Qf:()=>ee,oB:()=>Te});var n=r(6293),i=r(62845),a=r(92819),s=r(87514),l=r.n(s),o=r(73470),c=r(64893),d=r(9576);const{useGlobalState:u}=(0,i.r8)({cache:{}});function m({id:e,value:t,disabled:r,readonly:i,onChange:s,label:p,description:g,isMultiple:f=!1,path:h,query:E={},labelAttr:y,idAttr:b="id",searchArg:v="search"}){const[_,w]=u("cache"),S=(0,d.useInstanceId)(m,"itsec-entity-select-control");e=e||S;const[C,L]=(0,n.useState)(""),N=function(e,t,r,i,s,c,d){return(0,n.useCallback)((n=>l()({path:(0,o.addQueryArgs)(e,{...t,[s]:n})}).then((e=>e.map((e=>({value:e[i],label:e[r]}))))).then((t=>(d({...c,[e]:{...c[e]||{},...(0,a.mapValues)((0,a.keyBy)(t,"value"),"label")}}),t)))),[e,t,r,i,s,c,d])}(h,E,y,b,v,_,w);let O;return f?O=(t||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:_[h]?.[e]||e}))):t&&(O={value:t,label:_[h]?.[t]||t}),(0,n.createElement)(c.BaseControl,{className:"itsec-entity-select-control",label:p,help:g&&(0,n.createElement)(x,{noWrap:!0,content:g}),id:e,__nextHasNoMarginBottom:!0},(0,n.createElement)($,{"aria-label":p,"aria-describedby":g?e+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:e,isDisabled:r||i,isMulti:f,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:N,value:O,onChange:e=>s(f?(e||[]).map((e=>e.value)):e?.value),inputValue:C,onInputChange:L}))}var p=r(71930),g=r(31511);function f({errors:e,apiError:t,schemaError:r,title:i,className:a,hasBorder:s}){const l=[...e||[],...(0,g.Y3)(t),...(r||[]).map((e=>e.stack))];return l.length?(0,n.createElement)(p.rN,{messages:l,heading:i,className:a,hasBorder:s,type:"danger"}):null}var h=r(52117);const E=(0,h.Z)("div",{target:"e103ploj0"})({name:"1ff36h2",styles:"flex-grow:1"});function y(){return(0,n.createElement)(E,{"aria-hidden":!0})}var b=r(87462),v=r(63108),_=r(73727);function x({transform:e,...t}){return(0,n.createElement)(v.Lu,(0,b.Z)({},t,{transform:(r,i)=>{if(e){const t=e(r,i);if(void 0!==t)return t}if("a"===r.tagName.toLowerCase()&&r.dataset.itsecPath&&!t.noHtml)return(0,n.createElement)(_.rU,{to:r.dataset.itsecPath},i)}}))}var w=r(95122),S=r(65813),C=r(54639),L=r(33590);const N=(0,C.Zz)(L.ZP),O=(0,h.Z)(N,{target:"e1yg558d0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-bottom:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function I({saveLabel:e,isSaving:t,saveDisabled:r,cancelLabel:i,onCancel:a,cancelRoute:s,undoLabel:l,undoDisabled:o,onUndo:u,children:m,errors:p,apiError:g,schemaError:h,withCard:E,alignActions:y,...v}){let _=(0,d.useInstanceId)(I,"itsec-schema-form");_=v.id||_;const x=(0,n.createElement)(React.Fragment,null,(0,n.createElement)(f,{errors:p,apiError:g,schemaError:h}),(0,n.createElement)(T,(0,b.Z)({},v,{id:_})));return(0,n.createElement)(c.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,n.createElement)(c.FlexItem,null,E&&(0,n.createElement)(c.Card,null,(0,n.createElement)(c.CardBody,null,x)),!E&&x),(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(k,{id:_,saveLabel:e,cancelLabel:i,isSaving:t,saveDisabled:r,onCancel:a,cancelRoute:s,undoLabel:l,undoDisabled:o,onUndo:u,align:y},m)))}function T({className:e,...t}){return(0,n.createElement)(O,(0,b.Z)({},t,{className:e,additionalMetaSchemas:[r(27171)]}),(0,n.createElement)(React.Fragment,null))}function k({id:e,saveLabel:t=(0,w.__)("Save","better-wp-security"),isSaving:r,saveDisabled:i,cancelLabel:a=(0,w.__)("Cancel","better-wp-security"),onCancel:s,cancelRoute:l,undoLabel:o=(0,w.__)("Undo Changes","better-wp-security"),undoDisabled:d,onUndo:u,align:m,children:g}){return(0,n.createElement)(c.Flex,{align:m},s&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"tertiary",type:"button",onClick:s},a)),l&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(_.rU,{component:(0,S.Sj)(p.zx),variant:"tertiary",type:"button",to:l},a)),!m&&(0,n.createElement)(y,null),g,u&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"secondary",disabled:d,onClick:u},o)),(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"primary",isBusy:r,disabled:r||i,form:e,type:"submit"},t)))}var M=r(99196),A=r(35800),R=r(18526),D=r(29508);const Z=(0,M.lazy)((()=>Promise.all([r.e(4699),r.e(3157)]).then(r.bind(r,23157)))),F=(0,M.lazy)((()=>Promise.all([r.e(4699),r.e(4136)]).then(r.bind(r,64136)))),P=(0,M.lazy)((()=>Promise.all([r.e(4699),r.e(1323)]).then(r.bind(r,31323))));function H(){return(0,n.createElement)("span",null,(0,w.__)("Error when loading. Please refresh.","better-wp-security"))}const V=(0,D.iv)({name:"1nml846",styles:"input{min-height:0;}input:focus{box-shadow:none;}"});function j(){const e=(0,R.u)();return(0,n.useCallback)((t=>({...t,colors:{...t.colors,primary:e.colors.primary.base,primary75:e.colors.secondary.base,primary50:e.colors.tertiary.base,primary25:e.colors.surface.secondary}})),[e])}function B(){return(0,n.useMemo)((()=>({control:(e,t)=>({...e,minHeight:36,borderColor:t.isFocused?e.borderColor:"rgb(148, 148, 148)",borderRadius:2}),dropdownIndicator:e=>({...e,padding:6}),clearIndicator:e=>({...e,padding:6}),loadingIndicator:e=>({...e,padding:6}),valueContainer:e=>({...e,paddingTop:0,paddingBottom:0}),input:e=>({...e,paddingTop:0,paddingBottom:0})})),[])}function z({addErrorBoundary:e=!0,className:t,...r}){const i=j(),a=B(),s=(0,n.createElement)(M.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(Z,(0,b.Z)({},r,{className:(0,D.cx)(t,V),theme:i,styles:a})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:H},s):s}function $({addErrorBoundary:e=!0,className:t,...r}){const i=j(),a=B(),s=(0,n.createElement)(M.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(F,(0,b.Z)({},r,{className:(0,D.cx)(t,V),theme:i,styles:a})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:H},s):s}function q({addErrorBoundary:e=!0,className:t,...r}){const i=j(),a=B(),s=(0,n.createElement)(M.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(P,(0,b.Z)({},r,{className:(0,D.cx)(t,V),theme:i,styles:a})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:H},s):s}var U=r(32010),W=r(60976);const G=(0,h.Z)(p.Tg,{target:"ecpy66c3"})({name:"1x94tvs",styles:"display:flex;align-items:center;flex-shrink:0;padding:.5rem 1.5rem;min-height:calc(30px + 1rem);& .components-button:focus{box-shadow:none;}"}),K=(0,h.Z)(c.Toolbar,{target:"ecpy66c2"})({name:"gxzf6f",styles:"border:none;max-width:100%;margin-left:auto"}),Y=(0,h.Z)("div",{target:"ecpy66c1"})({name:"hlx1h5",styles:"display:flex;gap:0.5rem;margin:0 2rem 0 1rem;flex-grow:1"}),Q=(0,h.Z)(W.Ae,{target:"ecpy66c0"})({name:"1jxlbx4",styles:"height:2rem;width:2rem"});function X({area:e,...t}){return(0,n.createElement)(c.Slot,(0,b.Z)({name:`Toolbar${e}`},t))}function J({area:e="actions",...t}){return(0,n.createElement)(c.Fill,(0,b.Z)({name:`Toolbar${e}`},t))}function ee(){const e=(0,g.bv)("dashboard"),t=(0,d.useViewportMatch)("medium","<");return(0,n.createElement)(G,{role:"region","aria-label":(0,w.__)("Toolbar","better-wp-security")},t?(0,n.createElement)(Q,null):(0,n.createElement)(pe,null),(0,n.createElement)(X,{area:"main"},(e=>(0,n.createElement)(Y,null,e))),(0,n.createElement)(K,{label:(0,w.__)("Toolbar Actions","better-wp-security")},(0,n.createElement)(c.ToolbarButton,{icon:U.Z,href:e,text:(0,w.__)("Dashboard","better-wp-security")}),(0,n.createElement)(X,{area:"actions"})))}const te=(0,h.Z)("nav",{target:"e28bhoc2"})("display:flex;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),re=(0,h.Z)(_.OL,{target:"e28bhoc1"})("display:flex;text-decoration:none;align-items:center;&.active{box-shadow:inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),";}&:focus{color:",(({theme:e})=>e.colors.text.dark),";box-shadow:inset 0 0 0 2px ",(({theme:e})=>e.colors.border.info),",inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),"!important;border-radius:3px!important;}"),ne=(0,h.Z)(p.xv,{target:"e28bhoc0"})({name:"1i2l0vb",styles:"padding:.75rem 1.25rem"}),ie=(0,n.createContext)({size:p.yH.LARGE});function ae({className:e,size:t=p.yH.LARGE,children:r}){const i=(0,n.useMemo)((()=>({size:t})),[t]);return(0,n.createElement)(te,{className:e},(0,n.createElement)(ie.Provider,{value:i},r))}function se({title:e,...t}){const{size:r}=(0,n.useContext)(ie);return(0,n.createElement)(re,t,(0,n.createElement)(ne,{size:r,weight:p.fs.HEAVY,text:e,align:"center"}))}const le=(0,h.Z)(W.Ae,{shouldForwardProp:e=>"isSmall"!==e,target:"ewrt4zq0"})("height:",(({isSmall:e})=>e?"56px":"120px"),";width:",(({isSmall:e})=>e?"56px":"120px"),";");function oe({icon:e,isSmall:t=!1}){return(0,d.useMediaQuery)("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)")?e:(0,n.createElement)(le,{isSmall:t})}var ce=r(48015),de=r(31600);const ue=(0,h.Z)(W.sX,{target:"e1bzve6y1"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;"),me=(0,h.Z)(W.Pb,{target:"e1bzve6y0"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;");function pe({size:e=25,className:t}){const{installType:r}=(0,ce.useSelect)((e=>({installType:e(de.coreStore).getInstallType()})),[]);return"free"===r?(0,n.createElement)(ue,{size:e,className:t}):(0,n.createElement)(me,{size:e,className:t})}var ge=r(59588),fe=r.n(ge),he=r(76292),Ee=r.n(he),ye=r(82506),be=r(82521);const ve=(0,h.Z)("div",{target:"e1hwued11"})({name:"aj6rbz",styles:"display:flex;gap:0.5rem"}),_e=(0,h.Z)(p.zx,{target:"e1hwued10"})({name:"1o3nkn",styles:"margin-left:auto"}),xe=fe()((()=>[{value:"24-hours",label:(0,w.__)("24 Hours","better-wp-security")},{value:"week",label:(0,w.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,w.__)("30 Days","better-wp-security")},{value:"custom",label:(0,w.__)("Custom","better-wp-security")}]));function we({value:e,onChange:t}){const[r,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)(void 0),[o,d]=(0,n.useState)(void 0);let[u,m]=(0,n.useState)(void 0);const g=e,f=function(e){if(!e)return"";const t=new window.Date;let r,n;switch(e){case"24-hours":return(0,w.__)("24 Hours","better-wp-security");case"30-days":r=(0,be.dateI18n)("M j",t.setDate(t.getDate()-30)),n=(0,be.dateI18n)("M j, Y");break;case"week":r=(0,be.dateI18n)("M j",t.setDate(t.getDate()-7)),n=(0,be.dateI18n)("M j, Y");break;default:r=(0,be.dateI18n)("M j",e.start),n=(0,be.dateI18n)("M j, Y",e.end)}return(0,w.sprintf)((0,w.__)("%1$s - %2$s","better-wp-security"),r,n)}(g);return u=u||((0,a.isString)(g)?g:"custom"),(0,n.createElement)("div",null,(0,n.createElement)(p.zx,{onClick:()=>i(!r),title:f,"aria-expanded":r,"aria-label":(0,w.sprintf)((0,w.__)("%s (click to edit)","better-wp-security"),f),variant:"tertiary",text:f,icon:ye.Z,iconPosition:"right"}),r&&(0,n.createElement)(c.Modal,{title:(0,w.__)("Change Date Period","better-wp-security"),onRequestClose:()=>i(!1)},(0,n.createElement)(c.SelectControl,{options:xe(),value:u,onChange:e=>m(e)}),(0,n.createElement)(ve,null,"custom"===u&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,w.sprintf)((0,w.__)("From: %s (click to edit","better-wp-security"),(0,be.dateI18n)("M j",s)),text:(0,w.sprintf)((0,w.__)("From %s","better-wp-security"),(0,be.dateI18n)("M j",s))}),renderContent:()=>(0,n.createElement)(c.DatePicker,{currentDate:s,onChange:l,isInvalidDate:e=>{if((0,be.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,n.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,w.sprintf)((0,w.__)("To: %s (click to edit","better-wp-security"),(0,be.dateI18n)("M j",o)),text:(0,w.sprintf)((0,w.__)("To: %s (click to edit","better-wp-security"),(0,be.dateI18n)("M j",o))}),renderContent:()=>(0,n.createElement)(c.DatePicker,{currentDate:o,onChange:d,isInvalidDate:e=>!!(0,be.isInTheFuture)(e)||(0,be.getDate)(s)>e})})),(0,n.createElement)(_e,{variant:"primary",onClick:e=>{let r;if(e.preventDefault(),"custom"===u){const e=Ee()(s).set({hour:0,minute:0,second:0}),t=Ee()(o).set({hour:23,minute:59,second:59});r={start:(0,be.format)("Y-m-d\\TH:i:s",e),end:(0,be.format)("Y-m-d\\TH:i:s",t)}}else r=u;t(r),i(!1)},text:(0,w.__)("Apply","better-wp-security")}))))}const Se=(0,h.Z)(c.Icon,{target:"e1vmfdpe1"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),Ce=(0,h.Z)(c.Icon,{target:"e1vmfdpe0"})({name:"x749hy",styles:"background-color:#E6505466;border-radius:2rem;height:0.813rem!important;width:0.813rem!important;padding:2px"});var Le=r(28184),Ne=r(65202),Oe=r(67527);function Ie(){const{versionActive:e,versionSettings:t,installType:r}=(0,ce.useSelect)((e=>({versionActive:e(de.modulesStore).isActive("version-management"),versionSettings:e(de.modulesStore).getSettings("version-management"),installType:e(de.coreStore).getInstallType()})),[]),i=e&&t.update_if_vulnerable,a="free"===r,s=i?(0,w.__)("Real-Time Updates Active","better-wp-security"):(0,w.__)("Real-Time Updates Inactive","better-wp-security"),l=a?(0,w.__)("Upgrade","better-wp-security"):(0,w.__)("Enable “Auto Update If Fixes Vulnerability” in Version Management","better-wp-security"),o=i?(0,n.createElement)(Se,{icon:Le.Z}):(0,n.createElement)(Ce,{icon:Ne.Z,style:{fill:"#8A2424"}});return(0,n.createElement)(p.Ct,{text:s,icon:o,iconColor:"#FFFFFF",tooltip:l})}function Te(){const{hasPatchstack:e,installType:t}=(0,ce.useSelect)((e=>({hasPatchstack:e(de.coreStore).hasPatchstack(),installType:e(de.coreStore).getInstallType()})),[]),r="free"===t,i=e?(0,w.__)("Virtual Patching Active","better-wp-security"):(0,w.__)("Virtual Patching Inactive","better-wp-security"),a=r?(0,w.__)("Upgrade","better-wp-security"):null,s=e?Oe.Z:(0,n.createElement)(Ce,{icon:Ne.Z,style:{fill:"#8A2424"}});return(0,n.createElement)(p.Ct,{text:i,icon:s,iconColor:"#6817C5",tooltip:a})}},52278:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"}))},63708:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"}))},83904:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)(i.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"}))},96015:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)(i.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"}))},27231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}))},36058:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6293),i=r(14776);const a=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"}))},28306:(e,t,r)=>{"use strict";var n,i;function a(e){return[e]}function s(){var e={clear:function(){e.head=null}};return e}function l(e,t,r){var n;if(e.length!==t.length)return!1;for(n=r;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function o(e,t){var r,o;function c(){r=i?new WeakMap:s()}function d(){var r,n,i,a,s,c=arguments.length;for(a=new Array(c),i=0;i<c;i++)a[i]=arguments[i];for(s=t.apply(null,a),(r=o(s)).isUniqueByDependants||(r.lastDependants&&!l(s,r.lastDependants,0)&&r.clear(),r.lastDependants=s),n=r.head;n;){if(l(n.args,a,1))return n!==r.head&&(n.prev.next=n.next,n.next&&(n.next.prev=n.prev),n.next=r.head,n.prev=null,r.head.prev=n,r.head=n),n.val;n=n.next}return n={val:e.apply(null,a)},a[0]=null,n.args=a,r.head&&(r.head.prev=n,n.next=r.head),r.head=n,n.val}return t||(t=a),o=i?function(e){var t,i,a,l,o,c=r,d=!0;for(t=0;t<e.length;t++){if(!(o=i=e[t])||"object"!=typeof o){d=!1;break}c.has(i)?c=c.get(i):(a=new WeakMap,c.set(i,a),c=a)}return c.has(n)||((l=s()).isUniqueByDependants=d,c.set(n,l)),c.get(n)}:function(){return r},d.getDependants=t,d.clear=c,c(),d}r.d(t,{Z:()=>o}),n={},i="undefined"!=typeof WeakMap},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},25993:e=>{e.exports=function(){return this.wp.domReady}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},25703:e=>{e.exports=function(){return this.wp.notices}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash},76292:e=>{"use strict";e.exports=window.moment}},e=>{e.O(0,[7271,1930,5307,9443,135,9071,1511,976,6179],(()=>(32921,e(e.s=32921))));var t=e.O();((window.itsec=window.itsec||{}).pages=window.itsec.pages||{}).settings=t}]);